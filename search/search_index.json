{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Accueil","text":"<p>Convertir un document Word ou ODT vers un site statique HTML compatible MkDocs avec les IA Gemini 3 et ChatGPT 5.2</p> <p>Serge Tah\u00e9, janvier 2026</p> <p>Ce site a \u00e9t\u00e9 cr\u00e9\u00e9 avec le convertisseur [Word ou ODT - &gt; HTML] cr\u00e9\u00e9 par les IA Gemini 3 et ChatGPT 5.2 en janvier 2026 et d\u00e9crit par ce document.</p> <p>Avec le convertisseur Gemini / ChatGPT, plusieurs sites web ont \u00e9t\u00e9 produits \u00e0 partir de documents ODT de LibreOffice et de documents Word\u00a0:</p> <p>Java</p> <ul> <li>[Introduction au langage Java (1998)]\u00a0;</li> <li>[Introduction \u00e0 STRUTS 2 par l'exemple (2012)]\u00a0;</li> <li>[Introduction par l'exemple \u00e0 Java Server Faces, PrimeFaces et PrimeFaces Mobile (2012)]\u00a0;</li> <li>[Introduction au langage Java et \u00e0 l'\u00e9cosyst\u00e8me Spring au travers d'une \u00e9tude de cas (2015)]\u00a0;</li> <li>[Introduction \u00e0 Spring MVC et Thymeleaf par l\u2019exemple (2015)]</li> <li>[Exploiter une base de donn\u00e9es relationnelle avec l'\u00e9cosyst\u00e8me Spring (2015)]</li> </ul> <p>.NET</p> <ul> <li>[Apprentissage du langage C# Version 3.0 avec le Framework .NET 3.5 (2008)]\u00a0;</li> <li>[Introduction par l'exemple \u00e0 Entity Framework 5 Code First (2012)]\u00a0;</li> <li>[Introduction par l\u2019exemple au framework ASP.NET MVC par l\u2019exemple (2013)]\u00a0;</li> </ul> <p>Javascript</p> <ul> <li>[Introduction au langage ECMASCRIPT6 par l'exemple (2019)]\u00a0;</li> <li>[Introduction au framework VUE.JS par l'exemple (2019)]\u00a0;</li> <li>[Introduction au framework NUXT.JS par l'exemple (2019)]\u00a0;</li> </ul> <p>PHP</p> <ul> <li>[Introduction au langage PHP7 par l'exemple (2019)]\u00a0;</li> </ul> <p>Python</p> <ul> <li>[Introduction au langage Python et au framework web Flask par l'exemple (2020)]\u00a0;</li> <li>[G\u00e9n\u00e9rer un script Python avec des outils d\u2019IA (2025)]\u00a0;</li> </ul> <p>VBScript</p> <ul> <li>[Introduction au langage VBScript (2002)]\u00a0;</li> </ul> <p>Ce sont tous d\u2019anciens cours de plusieurs centaines de pages. La taille du document ODT ou DOCX n\u2019importe pas au convertisseur Gemini / ChatGPT. Ce qui lui importe ce sont les structures que l\u2019on y trouve (cf. chapitre\u00a0:  Les exemples de ce document).</p>"},{"location":"assurer-le-suivi-du-site-avec-google-analytics-et-google-search-console.html","title":"13. Assurer le suivi du site avec Google Analytics et Google Search Console","text":"<p>Si vous h\u00e9bergez votre site sur GitHub vous serez probablement int\u00e9ress\u00e9 par conna\u00eetre le nombre de visiteurs du site. Il vous faut pour \u00e7a un marqueur Google Analytics (GA). Nous demandons \u00e0 ChatGPT comment cr\u00e9er un marqueur GA\u00a0:</p> <ul> <li>En [1], mettez l\u2019URL de votre site web sur GitHub\u00a0;</li> </ul> <ul> <li>En [2], notez le marqueur\u00a0de votre site ;</li> </ul> <p>Mettez ce marqueur dans le fichier de configuration [config.py]\u00a0:</p> <pre><code>  \"extra\": {\n    \"analytics\": {\n      \"provider\": \"google\",\n      \"property\": \"G-XXXXXXXXX\"\n    }\n  },\n</code></pre> <p>Ligne 4, inscrivez votre marqueur. MkDocs le mettra automatiquement dans toutes vos pages HTML lorsqu\u2019il va g\u00e9n\u00e9rer le site HTML. Vous n\u2019avez donc pas besoin de suivre les autres instructions de ChatGPT qui montrent comment installer le marqueur GA dans vos pages HTML.</p> <p>On va demander \u00e0 ChatGPT des instructions pr\u00e9cises pour v\u00e9rifier que le marqueur fonctionne\u00a0:</p> <p>L\u2019\u00e9tape pr\u00e9c\u00e9dente n\u2019est pas assez claire. Voici quelques copies d\u2019\u00e9cran pour vous aider\u00a0:</p> <ul> <li>En [1], s\u00e9lectionnez le compte que vous voulez suivre\u00a0(au cas o\u00f9 vous en auriez plusieurs) ;</li> <li>En [2], s\u00e9lectionnez le bouton d\u2019administration\u00a0;</li> </ul> <ul> <li>En [3], s\u00e9lectionnez [Flux de donn\u00e9es]\u00a0;</li> </ul> <ul> <li>En [4], cliquez sur le flux de donn\u00e9es\u00a0;</li> </ul> <ul> <li>En [5], vous retrouvez le marqueur GA4 que vous avez cr\u00e9\u00e9\u00a0;</li> <li>En [6], l\u2019ID de flux. C\u2019est une notion diff\u00e9rente de l\u2019ID de mesure\u00a0;</li> </ul> <p>Revenons \u00e0 l\u2019accueil de GA\u00a0:</p> <ul> <li>En [1], demandez l\u2019affichage temps r\u00e9el des visites\u00a0;</li> </ul> <ul> <li>En [1], vous voyez vos visiteurs\u00a0;</li> <li>En [2], la page qui a \u00e9t\u00e9 visit\u00e9e. J\u2019ai demand\u00e9 au convertisseur Gemini d\u2019associer le nom du site plut\u00f4t que le nom de page au marqueur GA4. C\u2019est le fichier [analytics.html] qui assure ce changement de nom associ\u00e9 au GA4\u00a0:</li> </ul> <p>Maintenant on peut continuer avec les explications de ChatGPT\u00a0:</p> <p>J\u2019ai fait ce qui est demand\u00e9 en [4] sans passer par une fen\u00eatre priv\u00e9e. Et j\u2019ai obtenu ceci\u00a0:</p> <p>Le marqueur GA4 de Goggle Analytics est bien fonctionnel.</p> <p>Maintenant nous allons pr\u00e9senter un autre outil de suivi de votre site [Google Search Console]. Demandons \u00e0 ChatGPT \u00e0 quoi sert cet outil\u00a0:</p> <p>Je ne me sers quasiment jamais de cet outil. Je ne le fais que pour inciter le moteur de recherche Google \u00e0 l\u2019explorer et \u00e0 l\u2019indexer afin que des internautes puissent le trouver.</p> <p>L\u2019URL de l\u2019outil [https://search.google.com/search-console]\u00a0:</p> <ul> <li>En [1], la liste des sites qui ont \u00e9t\u00e9 d\u00e9clar\u00e9s \u00e0 Google\u00a0;</li> <li>En [3], la liste de vos sites\u00a0;</li> <li>En [4], ajoutez votre nouveau site\u00a0;</li> </ul> <ul> <li>En [5], tapez l\u2019URL de votre site. Elle est dans le fichier [config.py]\u00a0:</li> </ul> <pre><code>    \"site_url\": \"https://stahe.github.io/word-odt-vers-html-janv-2026/\",\n</code></pre> <ul> <li>en [6], passez \u00e0 l\u2019\u00e9tape suivante\u00a0;</li> </ul> <p>Normalement \u00e0 cette \u00e9tape, Google Search Console vous propose un fichir [googlexxxxx.html] que vous devez t\u00e9l\u00e9charger. Je n\u2019ai pas eu cet \u00e9cran car j\u2019avais d\u00e9j\u00e0 ce fichier dans le site d\u00e9ploy\u00e9. C\u2019est l\u2019un des deux fichiers d\u00e9clar\u00e9s dans [config.py]</p> <pre><code>  \"files_to_copy\": [\n    \"google5179xxxxx.html\",\n    \"robots.txt\"\n  ]\n</code></pre> <p>Mettez le fichier [googlexxxxx.html] \u00e0 la racine de votre dossier de travail et inscrivez son nom \u00e0 la ligne 2 ci-dessus du fichier [config.py]. Le script [convert] s\u2019occupe de mettre les deux fichiers ci-dessus \u00e0 la racine du site MkDocs qu\u2019il g\u00e9n\u00e8re. Le script [build] lui les mettra \u00e0 la racine du site HTML g\u00e9n\u00e9r\u00e9.</p> <p>Lorsque vous avez copi\u00e9 le fichier [googlexxxxx.html] \u00e0 la racine de votre dossier de travail, v\u00e9rifiez le contenu du fichier [robots.txt]\u00a0:</p> <p>Le contenu du fichier [robots.txt] est le suivant\u00a0:</p> <pre><code>\nUser-agent: *\nAllow: /\nSitemap: https://stahe.github.io/word-odt-vers-html-janv-2026/sitemap.xml\n</code></pre> <p>En ligne 3, v\u00e9rifiez bien que  l\u2019URL est celle de votre site, la m\u00eame que dans le fichier [config.py].</p> <p>Red\u00e9ployez votre site web sur GitHub en tapant les trois commandes suivantes dans votre terminal Python\u00a0:</p> <pre><code>python .\\convert.py .\\word-odt-vers-HTML.odt config.py\npython .\\build.py\npython -m mkdocs gh-deploy\n</code></pre> <p>Ceci fait, retournez dans [Google Search Console] et s\u00e9lectionnez la propri\u00e9t\u00e9 que vous avez cr\u00e9\u00e9e pr\u00e9c\u00e9demment.</p> <ul> <li>En [1], s\u00e9lectionnez l\u2019option [Sitemaps]\u00a0;</li> <li>En [2], tapez [sitemap.xml]\u00a0;</li> <li>En [3], validez l\u2019URL\u00a0;</li> </ul> <p>Le fichier [sitemap.xml] est un fichier que Mkdocs a mis \u00e0 la racine du site HTML export\u00e9 sur GitHub. Vous pouvez v\u00e9rifier sa pr\u00e9sence en tapant directement son URL\u00a0:</p> <p>Le fichier [sitemap.xml] liste toutes les pages HTML du site.</p> <p>Si tout va bien, vous obtenez l\u2019\u00e9cran suivant\u00a0:</p> <p>C\u2019est tout. Vous devrez indexer les pages du site vous-m\u00eame\u00a0:</p> <ul> <li>En [2], tapez l\u2019URL d\u2019une des pages de votre site\u00a0;</li> </ul> <p>Ici, le r\u00e9sultat est le suivant\u00a0:</p> <ul> <li>En [1], Google dit que la page n\u2019est pas encore index\u00e9e\u00a0;</li> <li>En [2], vous pouvez demander son indexation\u00a0;</li> </ul> <p>Google Search Console v\u00e9rifie alors que la page demand\u00e9e peut \u00eatre index\u00e9e. Si oui, on obtient le message suivant\u00a0:</p> <p>Vous pouvez faire cela pour toutes les pages de votre site afin d\u2019\u00eatre s\u00fbr qu\u2019il est bien index\u00e9 par le moteur de recherche de Google.</p>"},{"location":"ce-qui-existe-sur-internet.html","title":"3. Ce qui existe sur internet","text":"<p>Avant de commencer, on peut demander \u00e0 l\u2019IA ce qui existe sur le march\u00e9 pour convertir un document Word ou ODT en site statique HTML et qui serait gratuit.</p> <p>Posons la question \u00e0 Gemini\u00a0:</p> <p>Voici sa r\u00e9ponse\u00a0:</p> <p>Oui, il existe plusieurs solutions gratuites, mais le choix d\u00e9pend de votre d\u00e9finition d'un \"site statique\" (une simple page HTML vs un site complet avec navigation) et de vos comp\u00e9tences techniques.</p><p>Voici les meilleures options class\u00e9es par m\u00e9thode :</p><p>\u2022 1. La solution \"Tout-en-un\" (Pour cr\u00e9er un vrai site navigable)</p><p>Si vous voulez transformer un long document Word (avec chapitres et sous-chapitres) en un site web complet avec un menu de navigation \u00e0 gauche, c'est la meilleure option.</p><p>\u2022 Logiciel : HelpNDoc (Version gratuite pour usage personnel)</p><p>\u2022 Comment \u00e7a marche : C'est un logiciel de cr\u00e9ation de documentation. Vous importez votre fichier Word, il analyse la structure (Titres 1, Titres 2...) et g\u00e9n\u00e8re automatiquement un site HTML5 statique et \"responsive\" (adapt\u00e9 aux mobiles).</p><p>\u2022 Les + : Cr\u00e9e un vrai site avec menu, barre de recherche et index sans \u00e9crire une ligne de code.</p><p>\u2022 Le - : La version gratuite ajoute une petite banni\u00e8re \"G\u00e9n\u00e9r\u00e9 par HelpNDoc\" en bas de page.</p><p>\u2022 2. La solution \"Nettoyeur en ligne\" (Pour convertir page par page)</p><p>Si vous avez un document court et que vous voulez juste obtenir le code HTML pour le mettre sur une page existante, les convertisseurs en ligne sont id\u00e9aux pour nettoyer le code \"sale\" g\u00e9n\u00e9r\u00e9 par Word.</p><p>\u2022 Outil : WordToHTML.net (ou Word2CleanHTML)</p><p>\u2022 Comment \u00e7a marche :</p><p>\u2022 Vous copiez votre texte dans Word.</p><p>\u2022 Vous le collez dans l'\u00e9diteur visuel de gauche sur le site.</p><p>\u2022 Le site g\u00e9n\u00e8re un code HTML propre (nettoy\u00e9 des balises inutiles de Microsoft) dans la fen\u00eatre de droite.</p><p>\u2022 Les + : Tr\u00e8s simple, visuel, retire le \"gras\" du code Microsoft.</p><p>\u2022 Le - : Id\u00e9al pour une page unique, pas pour g\u00e9n\u00e9rer l'architecture d'un site entier.</p><p>\u2022 3. La solution \"Pro / D\u00e9veloppeur\" (La meilleure qualit\u00e9)</p><p>C'est la m\u00e9thode recommand\u00e9e par les experts pour obtenir un code ultra-propre et p\u00e9renne.</p><p>\u2022 Logiciel : Pandoc (Ligne de commande)</p><p>\u2022 Comment \u00e7a marche : C'est un petit programme sans interface graphique (\u00e0 utiliser via le terminal/invite de commande). Il convertit les formats de mani\u00e8re tr\u00e8s pr\u00e9cise.</p><p>\u2022 Commande type : pandoc mon_document.docx -t html -o mon_site.html</p><p>\u2022 Les + : Code HTML5 parfait, gratuit, open-source, g\u00e8re tr\u00e8s bien les images et les formules math\u00e9matiques (LaTeX).</p><p>\u2022 Le - : N\u00e9cessite d'\u00eatre \u00e0 l'aise avec une invite de commande (\u00e9cran noir).</p><p>\u2022 4. La solution \"Syst\u00e8me D\" (Microsoft Word)</p><p>Vous pouvez le faire directement depuis Word, mais attention au r\u00e9sultat.</p><p>\u2022 M\u00e9thode : Fichier &gt; Enregistrer sous &gt; Choisir \"Page Web filtr\u00e9e (*.htm; *.html)\".</p><p>\u2022 Important : Ne choisissez pas \"Page Web \u00e0 fichier unique (.mht)\", choisissez bien \"Filtr\u00e9e\". L'option \"Filtr\u00e9e\" r\u00e9duit (un peu) le code superflu que Word ajoute habituellement.</p><p>\u2022 Le - : Le code reste souvent lourd et difficile \u00e0 modifier par la suite.</p><p>\u2022 Tableau Comparatif Rapide</p><p>Solution</p><p>Type de r\u00e9sultat</p><p>Qualit\u00e9 du code</p><p>Facilit\u00e9</p><p>Id\u00e9al pour...</p><p>HelpNDoc</p><p>Site complet (avec menu)</p><p>Bonne</p><p>Moyenne</p><p>Manuels, th\u00e8ses, documentation</p><p>WordToHTML</p><p>Page unique</p><p>Excellente</p><p>Tr\u00e8s Facile</p><p>Articles de blog, pages simples</p><p>Pandoc</p><p>Page unique (brute)</p><p>Parfaite</p><p>Difficile</p><p>D\u00e9veloppeurs, archivage propre</p><p>Word (Natif)</p><p>Page unique</p><p>Mauvaise</p><p>Facile</p><p>D\u00e9pannage rapide</p><p>\u2022 Mon conseil</p><p>Si votre objectif est de publier ce document en ligne de fa\u00e7on professionnelle, je vous sugg\u00e8re HelpNDoc si vous \u00eates d\u00e9butant et que vous voulez une structure de site imm\u00e9diate.</p><p>Si vous souhaitez simplement le contenu propre pour le coller ailleurs (WordPress, etc.), utilisez WordToHTML.net.</p><p>Souhaitez-vous que je vous d\u00e9taille la proc\u00e9dure pas-\u00e0-pas pour l'un de ces outils (par exemple WordToHTML) ?</p> <p>J\u2019ai utilis\u00e9 parfois [Pandoc] mais j\u2019avais trouv\u00e9 son usage difficile. Je me rappelle qu\u2019il fallait \u00ab\u00a0pr\u00e9parer\u00a0\u00bb le document Word pour qu\u2019il soit correctement g\u00e9r\u00e9 par Pandoc. Cependant le r\u00e9sultat \u00e9tait excellent. HelpNDoc semble un logiciel attirant puisqu\u2019il g\u00e9n\u00e8re un site avec menu. Je l\u2019ai test\u00e9 sur un de mes documents Word et le r\u00e9sultat n\u2019a pas \u00e9t\u00e9 satisfaisant.</p> <p>Maintenant cherchons s\u2019il existe un logiciel de conversion pour les documents ODT\u00a0:</p> <p>La r\u00e9ponse de Gemini est la suivante\u00a0:</p> <p>Oui, tout \u00e0 fait. Comme pour Word, le format ODT (utilis\u00e9 par LibreOffice et OpenOffice) dispose de ses propres solutions.</p><p>Voici les meilleures options gratuites sp\u00e9cifiques aux fichiers ODT, class\u00e9es par m\u00e9thode :</p><p>\u2022 1. La solution \"Extension\" (La meilleure qualit\u00e9 int\u00e9gr\u00e9e)</p><p>Si vous utilisez LibreOffice ou OpenOffice, l'export HTML de base est (comme pour Word) assez m\u00e9diocre. Cependant, il existe une extension gratuite formidable con\u00e7ue sp\u00e9cifiquement pour cela.</p><p>\u2022 Outil : Writer2xhtml (Extension pour LibreOffice)</p><p>\u2022 Comment \u00e7a marche :</p><p>\u2022 Vous t\u00e9l\u00e9chargez et installez l'extension dans LibreOffice.</p><p>\u2022 Vous faites Fichier &gt; Exporter et une nouvelle option \"XHTML 1.1 + MathML\" (ou similaire) appara\u00eet.</p><p>\u2022 Les + : Le code est beaucoup plus propre que l'export standard, et il g\u00e8re tr\u00e8s bien les formules math\u00e9matiques et la mise en forme complexe.</p><p>\u2022 Le - : Il faut installer une extension (manipulation technique unique).</p><p>\u2022 2. La solution \"Pro / Ligne de commande\" (Universelle)</p><p>C'est le m\u00eame outil que pour Word, car il excelle aussi avec le format ODT.</p><p>\u2022 Logiciel : Pandoc</p><p>\u2022 Comment \u00e7a marche : Via le terminal de commande.</p><p>\u2022 Commande : pandoc mon_fichier.odt -t html -o mon_site.html</p><p>\u2022 Les + : C'est sans doute le convertisseur le plus puissant du march\u00e9 pour le format ODT vers HTML. Il \"comprend\" la structure du document ODT mieux que quiconque.</p><p>\u2022 3. La solution \"Site Complet avec Navigation\" (Via HelpNDoc)</p><p>HelpNDoc (mentionn\u00e9 pr\u00e9c\u00e9demment) est toujours la meilleure option gratuite pour cr\u00e9er un vrai site avec menu \u00e0 gauche.</p><p>Cependant, HelpNDoc n'importe pas toujours nativement le format .odt aussi bien que le .docx.</p><p>\u2022 L'astuce :</p><p>\u2022 Ouvrez votre fichier dans LibreOffice.</p><p>\u2022 Faites Enregistrer sous... et choisissez \"Word 2007-365 (.docx)\".</p><p>\u2022 Importez ce fichier .docx dans HelpNDoc pour g\u00e9n\u00e9rer votre site.</p><p>\u2022 Pourquoi ? Cela garantit que la hi\u00e9rarchie de vos chapitres (Titres 1, Titres 2) est parfaitement reconnue pour cr\u00e9er le menu du site.</p><p>\u2022 4. La solution en ligne (Nettoyage rapide)</p><p>Certains outils en ligne acceptent directement le ODT pour en sortir du HTML propre.</p><p>\u2022 Outil : WordToHTML.net (Accepte aussi les ODT)</p><p>\u2022 Comment \u00e7a marche : Vous pouvez uploader votre fichier ODT directement ou coller votre texte.</p><p>\u2022 Les + : Tr\u00e8s pratique pour convertir un article unique sans rien installer.</p><p>\u2022 R\u00e9sum\u00e9 de mon conseil pour du ODT :</p><p>\u2022 Pour un vrai site (Documentation/Th\u00e8se) : Convertissez votre ODT en DOCX via LibreOffice, puis utilisez HelpNDoc (c'est la m\u00e9thode la plus fiable pour avoir un menu de navigation).</p><p>\u2022 Pour une page simple et propre : Utilisez l'extension Writer2xhtml si vous faites cela souvent, ou Pandoc si vous voulez automatiser la t\u00e2che.</p><p>Voulez-vous que je vous explique comment installer l'extension Writer2xhtml dans LibreOffice ?</p> <p>J\u2019ai test\u00e9 l\u2019extension de LibreOffice [Writer2xhtml] sur un de mes documents. Ca donne quelque chose de lisible mais pas suffisamment professionnel. On n\u2019a pas de table des mati\u00e8res sur la gauche. Les blocs de code perdent leur coloration syntaxique.</p> <p>Au final je pense que le convertisseur g\u00e9n\u00e9r\u00e9 par Gemini est une alternative \u00e0 ce qui est propos\u00e9 ci-dessus. Le r\u00e9sultat est comparable \u00e0 celui produit par Pandoc si le document ODT convient au convertisseur.</p>"},{"location":"conclusion.html","title":"14. Conclusion","text":"<p>Nous avons montr\u00e9 dans ce document un convertisseur de documents ODT produits par LibreOffice ou de documents DOCX de Word en un site statique HTML de tr\u00e8s bonne qualit\u00e9.</p> <p>Nous avons pr\u00e9sent\u00e9 dans le chapitre [Les exemples de ce document] les structures g\u00e9r\u00e9es correctement par le convertisseur Gemini / ChatGPT.</p> <p>Nous avons montr\u00e9 \u00e9galement comment exporter sur GitHub les sites HTML cr\u00e9\u00e9s par les convertisseurs ODT et  DOCX (cf chapitre H\u00e9berger le site HTML sur GitHub)</p> <p>En dehors des structures du chapitre des exemples, rien n\u2019est garanti. Il est probable que le convertisseur montrera des anomalies. Il faudra alors de nouveau commencer un chat avec Gemini ou ChatGPT pour r\u00e9soudre ces anomalies. Le plus simple est de donner le convertisseur actuel \u00e0 l\u2019IA avec son fichier de configuration. Puis de demander \u00e0 l\u2019IA s\u2019il comprend les codes qu\u2019on lui a donn\u00e9s. Cela la force \u00e0 analyser le code. Elle r\u00e9pondra toujours qu\u2019elle comprend parfaitement le code. Ce sera le moment de lui demander les changements d\u00e9sir\u00e9s. Aussi bien pour Word que LibreOffice, vous pouvez aider l\u2019IA avec des macros. L\u2019IA ne \u00ab\u00a0voit\u00a0\u00bb pas le document ODT ou DOCX exploit\u00e9. Il lui manque donc des informations. Ainsi le convertisseur DOCX -&gt; HTML n\u2019arrivait pas \u00e0 g\u00e9rer correctement la num\u00e9rotation des codes riches. Elle ne savait pas lire le num\u00e9ro de la premi\u00e8re ligne d\u2019un bloc de code pour le rendre en HTML. Elle commen\u00e7ait toujours le code \u00e0 1 m\u00eame si le code dans le DOCX commen\u00e7ait \u00e0 12. Je me suis alors aid\u00e9 d\u2019une macro. J\u2019ai plac\u00e9 le curseur du document sur la ligne num\u00e9rot\u00e9e et j\u2019ai demand\u00e9 \u00e0 ChatGPT de g\u00e9n\u00e9rer une macro VBA qui lui donnerait les caract\u00e9ristiques de cette ligne, qui lui permettraient de g\u00e9n\u00e9rer correctement la num\u00e9rotation HTML. ChatGPT l\u2019a fait et je lui ai donn\u00e9 le r\u00e9sultat de sa macro. Ca l\u2019a d\u00e9bloqu\u00e9\u00a0: les informations r\u00e9cup\u00e9r\u00e9es lui montraient que le num\u00e9ro de la ligne \u00e9tait propag\u00e9 par son style et non par l\u2019ic\u00f4ne de num\u00e9rotation. Il a alors chang\u00e9 son algorithme qui a fonctionn\u00e9. Donc on peut aider l\u2019IA \u00e0 avancer.</p> <p>Une autre voie plus simple est de changer son document. Quand le convertisseur produit une anomalie, essayez de modifier votre document pour qu\u2019il n\u2019utilise que les structures du chapitre des exemples.</p>"},{"location":"construction-du-site-html-statique.html","title":"10. Construction du site HTML statique","text":"<p>A partir de maintenant il n\u2019y a plus de diff\u00e9rence entre documents ODT et DOCX. On travaille sur le site MkDocs construit par l\u2019un ou l\u2019autre des convertisseurs.</p> <p>Maintenant construisons le site HTML. Cela se fait avec le script [build]. Toujours dans le terminal, tapez la commande suivante\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python .\\build.py\nD\u00e9marrage de la construction du site MkDocs...\nConstruction r\u00e9ussie ! Le site est dans : C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2\\site\nOuverture de C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2\\site\\index.html dans le navigateur\u2026\n</code></pre> <ul> <li>ligne 1\u00a0: la commande [python build] cr\u00e9e le site HTML \u00e0 partir du site MkDocs\u00a0;</li> <li>ligne 4\u00a0: le site est affich\u00e9 dans un navigateur\u00a0;</li> </ul> <p>Le r\u00e9sultat est le m\u00eame que pour le site MkDocs\u00a0:</p> <ul> <li>En [1], on voit que c\u2019est une page HTML qui est affich\u00e9e\u00a0;</li> <li>En [2], cette page correspond \u00e0 la page d\u2019accueil du site\u00a0;</li> <li>En [3], la table des mati\u00e8res du document HTML\u00a0;</li> <li>En [4], le titre du document a \u00e9t\u00e9 format\u00e9 selon sa configuration dans [config.py]\u00a0;</li> <li>En [5], la premi\u00e8re page affich\u00e9e est [Accueil]. Le contenu de cette page est le contenu du Document ODT / DOCX qui pr\u00e9c\u00e8de le premier chapitre de niveau Titre 1\u00a0;</li> </ul> <p>L\u2019ex\u00e9cution de [build] a modifi\u00e9 votre dossier de travail\u00a0:</p> <ul> <li>En [1], un nouveau dossier [site] a \u00e9t\u00e9 cr\u00e9\u00e9. Il contient votre site statique HTML\u00a0;</li> <li>En [2], les pages de votre site\u00a0;</li> </ul>"},{"location":"creer-un-environnement-de-travail-python.html","title":"5. Cr\u00e9er un environnement de travail Python","text":""},{"location":"creer-un-environnement-de-travail-python.html#5-creer-un-environnement-de-travail-python","title":"5. Cr\u00e9er un environnement de travail Python","text":"<p>Gemini et ChatGPT vont g\u00e9n\u00e9rer deux scripts Python. Il nous faut donc un environnement Python\u00a0:</p> <ul> <li>L\u2019installation de Python est pr\u00e9sent\u00e9 au paragraphe 3.1 de [ref1]\u00a0;</li> <li>L\u2019installation de PyCharm est pr\u00e9sent\u00e9 au paragraphe 3.2 de [ref1]. [ref1] pr\u00e9sente une longue configuration de PyCharm. Ici, PyCharm ne sera utilis\u00e9 que pour ex\u00e9cuter les scripts Python g\u00e9n\u00e9r\u00e9s par Gemini et ChatGPT. Donc toute configuration de PyCharm est inutile. PyCharm sera utilis\u00e9 \u00e9galement pour pr\u00e9senter les fichiers n\u00e9cessaires au convertisseur\u00a0;</li> </ul>"},{"location":"examen-du-site-html-genere.html","title":"11. Examen du site HTML g\u00e9n\u00e9r\u00e9","text":"<p>Nous allons examiner maintenant le rendu HTML de ce Document ODT / DOCX. On a d\u00e9j\u00e0 vu que le convertisseur respectait la table des mati\u00e8res.</p>"},{"location":"examen-du-site-html-genere.html#111-la-barre-superieure-du-site","title":"11.1. La barre sup\u00e9rieure du site","text":"<p>Regardons la barre sup\u00e9rieure du site\u00a0:</p> <ul> <li>En [1], le nom du site d\u00e9fini dans [config.py]\u00a0;</li> <li>En [2], l\u2019ic\u00f4ne qui permet de passer au mode sombre ou clair\u00a0;</li> <li>En [3], l\u2019ic\u00f4ne qui est un lien sur le d\u00e9p\u00f4t GitHub o\u00f9 sera export\u00e9 le site HTML. Aussi d\u00e9fini dans [config.py]\u00a0;</li> <li>En [4], l\u2019ic\u00f4ne qui permet de cacher / montrer la table des mati\u00e8res\u00a0;</li> </ul>"},{"location":"examen-du-site-html-genere.html#112-le-bas-de-page-du-site","title":"11.2. Le bas de page du site","text":"<p>Regardons maintenant le bas de page\u00a0:</p> <p>C\u2019est le bas de page d\u00e9fini dans le fichier [config.py].</p>"},{"location":"examen-du-site-html-genere.html#113-la-page-daccueil","title":"11.3. La page d\u2019accueil","text":"<p>La page de titre du Document ODT / DOCX \u00e9tait la suivante\u00a0:</p> <p>Cette page de titre du Document ODT / DOCX devient la page d\u2019accueil du site HTML\u00a0:</p> <p>Le convertisseur Gemini 3 / ChatGPT met dans la page Accueil tout ce qui pr\u00e9c\u00e8de, dans le Document ODT / DOCX, le premier titre de niveau 1, de style \u2018Titre 1\u2019 donc. Si vous y mettez des images comme ci-dessus, il va les afficher. Vous pouvez donc imaginer donner une couverture \u00e0 votre site comme avec un livre r\u00e9el. En [1], c\u2019est le titre principal du document. Son rendu est contr\u00f4l\u00e9 par le lignes suivantes du fichier de configuration [config.py]\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # D\u00e9tection du Titre du Document\n    # -------------------------------------------------------------------------\n    \"document_title\": {\n        # Styles ODT \u00e0 consid\u00e9rer comme le titre principal du document (H1 global)\n        \"style_names\": [\n            \"P1\"\n        ],\n        # CSS appliqu\u00e9 \u00e0 ce titre dans le Markdown g\u00e9n\u00e9r\u00e9\n        \"css\": \"font-size: 28px; font-weight: bold; margin-bottom: 1em; line-height: 1.2; color: #2c3e50;\"\n    },\n</code></pre> <ul> <li>lignes [6-8]\u00a0: la liste des styles possibles pour le titre de votre document. Quand je regarde ce document, le style LibreOffice de mon titre est \u2018Titre principal\u2019. Or le convertisseur Gemini ne le trouvait pas. Il a fait des logs des styles qu\u2019il rencontrait et cela a affich\u00e9 [P1]. C\u2019est un gros souci avec LibreOffice\u00a0: les noms affich\u00e9s des styles ne correspondent pas aux noms internes utilis\u00e9s par le logiciel. Ils ne sont l\u00e0 que pour s\u2019adapter \u00e0 la langue de l\u2019utilisateur\u00a0;</li> <li>ligne 10\u00a0: une fois que le titre principal a \u00e9t\u00e9 d\u00e9tect\u00e9, vous pouvez param\u00e9trer son rendu. Moi je voulais une police de taille 28 (font-size: 28px;) et du gras (font-weight: bold)\u00a0;</li> </ul> <p>Avec les images et le style du titre, vous pouvez faire une page d\u2019accueil attirante.</p> <p>Le titre principal de votre document n\u2019aura peut-\u00eatre pas un des styles d\u00e9finis aux lignes [6-8]. Pour trouver le style de votre titre principal, utilisez la ligne suivante du fichier [config.py]</p> <pre><code>  \"debug\": True\n</code></pre> <p>Avec la valeur [true], le style des paragraphes qui pr\u00e9c\u00e8dent le premier titre de niveau 1, donc les paragraphes de la page d\u2019accueil, va \u00eatre affich\u00e9 lors de l\u2019ex\u00e9cution du convertisseur Gemini / ChatGPT. Ainsi pour un autre document que celui-ci, j\u2019ai obtenu les logs suivants\u00a0:</p> <pre><code>\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P3' (Clean='p3') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P1' (Clean='p1') | Texte='...'\n[DEBUG PRE-H1] Style='P4' (Clean='p4') | Texte='Introduction au langage PHP7 par l\u2019exemp...'\n&gt;&gt;&gt; TITRE DOCUMENT DETECT\u00c9 : Introduction au langage PHP7 par l\u2019exemple\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='Standard (WW)' (Clean='standard (ww)') | Texte='...'\n[DEBUG PRE-H1] Style='P5' (Clean='p5') | Texte='Serge Tah\u00e9, juillet 2019...'\n[DEBUG PRE-H1] Style='P5' (Clean='p5') | Texte='...'\n[DEBUG PRE-H1] Style='P6' (Clean='p6') | Texte='...'\n[DEBUG PRE-H1] Style='Heading 1' (Clean='heading 1') | Texte='Introduction au langage PHP 7...'\n</code></pre> <ul> <li>ligne 10, le titre du document a le style \u2018P4\u2019\u00a0;</li> </ul> <p>Dans le fichier [config.py], j\u2019ai alors mis les lignes suivantes\u00a0:</p> <pre><code>\n  \"document_title\": {\n    \"style_names\": [\n      \"P4\"\n    ],\n    \"css\": \"font-size: 28px; font-weight: bold; margin-bottom: 1em; line-height: 1.2; color: #2c3e50;\"\n  },\n</code></pre> <ul> <li>ligne 3, le style que je cherchais\u00a0;</li> </ul> <p>C\u2019est pour cette raison que le d\u00e9bogueur affiche les lignes\u00a0:</p> <pre><code>\n[DEBUG PRE-H1] Style='P4' (Clean='p4') | Texte='Introduction au langage PHP7 par l\u2019exemp...'\n&gt;&gt;&gt; TITRE DOCUMENT DETECT\u00c9 : Introduction au langage PHP7 par l\u2019exemple\n</code></pre> <p>Il a rencontr\u00e9 le style \u2018P4\u2019 et affiche alors que le titre du document a \u00e9t\u00e9 trouv\u00e9. Lorsque celui-ci a \u00e9t\u00e9 trouv\u00e9, vous pouvez mettre la cl\u00e9 [debug] \u00e0 [false] dans [config.py]\u00a0:</p> <pre><code>  \"debug\": False\n</code></pre> <p>Regardons maintenant la conversion du chapitre [Exemples] qui regroupe les exemples que le convertisseur Gemini / ChatGPT sait g\u00e9rer\u00a0:</p>"},{"location":"examen-du-site-html-genere.html#114-les-listes-a-puces","title":"11.4. Les listes \u00e0 puces","text":"<p>Document ODT / DOCX\u00a0:</p> <p>Cidessus, le texte [Listes \u00e0 puces] est surlign\u00e9 parce que c\u2019est une r\u00e9f\u00e9rence associ\u00e9e \u00e0 un renvoi.</p> <p>Document HTML\u00a0:</p> <p>On remarque si le Document ODT / DOCX utilise diff\u00e9rentes puces, le document HTML n\u2019utilise qu\u2019une sorte de puce.</p>"},{"location":"examen-du-site-html-genere.html#115-les-listes-numerotees","title":"11.5. Les listes num\u00e9rot\u00e9es","text":"<p>Document ODT / DOCX\u00a0:</p> <p>Document HTML\u00a0:</p>"},{"location":"examen-du-site-html-genere.html#1151-listes-mixtes-1","title":"11.5.1. Listes mixtes 1","text":"<p>Document ODT / DOCX</p> <p>Document HTML</p> <p>L\u00e0 \u00e9galement, il y a parfois des diff\u00e9rences entre les types de puces utilis\u00e9s.</p>"},{"location":"examen-du-site-html-genere.html#1152-listes-mixtes-2","title":"11.5.2. Listes mixtes 2","text":"<p>Document ODT / DOCX</p> <p>Document HTML</p>"},{"location":"examen-du-site-html-genere.html#116-les-blocs-de-code-enrichis","title":"11.6. Les blocs de code enrichis","text":"<p>Les blocs de code enrichi sont rendus \u00e0 l\u2019identique dans le HTML (en-dehors de la couleur de fond). Voici trois exemples\u00a0:</p>"},{"location":"examen-du-site-html-genere.html#1161-exemple-1","title":"11.6.1. Exemple 1","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1162-exemple-2","title":"11.6.2. Exemple 2","text":"<p>Document ODT / DOCX\u00a0:</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1163-exemple-3","title":"11.6.3. Exemple 3","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#117-les-blocs-de-code-brut-plain-text","title":"11.7. Les blocs de code brut (plain text)","text":"<p>Les blocs de code brut trouv\u00e9s dans le Document ODT / DOCX sont color\u00e9s syntaxiquement par MkDocs selon le langage trouv\u00e9 dans le bloc de code. Pour aider le convertisseur \u00e0 trouver le bon langage, on a mis des \u00ab\u00a0cha\u00eenes cl\u00e9s\u00a0\u00bb dans le fichier [config.py] pour chaque langage. Le convertisseur compte les \u00ab\u00a0cha\u00eenes cl\u00e9s\u00a0\u00bb trouv\u00e9es. Il associe alors le bloc de code au langage ayant le plus de \u00ab\u00a0cha\u00eenes cl\u00e9s\u00a0\u00bb trouv\u00e9es.</p> <p>Voyons quelques exemples.</p>"},{"location":"examen-du-site-html-genere.html#1171-exemple-1","title":"11.7.1. Exemple 1","text":"<p>Document ODT / DOCX (Java)</p> <p>Rendu HTML</p> <p>Dans le document HTML on voit que le code Java a \u00e9t\u00e9 color\u00e9 syntaxiquement.</p>"},{"location":"examen-du-site-html-genere.html#1172-exemple-2","title":"11.7.2. Exemple 2","text":"<p>Document ODT / DOCX (XML)</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1173-exemple-3","title":"11.7.3. Exemple 3","text":"<p>Document ODT / DOCX (HTML)</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#118-autres-blocs-de-code","title":"11.8. Autres blocs de code","text":"<p>Document ODT / DOCX</p> <p>Un r\u00e9sultat d\u2019ex\u00e9cution avec une premi\u00e8re ligne qui ne commence pas \u00e0 1\u00a0:</p> <p>Rendu HTML</p> <p>Un bloc de code non num\u00e9rot\u00e9 dans ODT le reste dans le HTML\u00a0:</p> <p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#119-les-liens","title":"11.9. Les liens","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1110-lenrichissement-de-texte","title":"11.10. L\u2019enrichissement de texte","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1111-les-images","title":"11.11. Les images","text":"<p>Il faut noter que le convertisseur Gemini / ChatGPT respecte les redimensionnements des images, faits dans le Document ODT / DOCX.</p>"},{"location":"examen-du-site-html-genere.html#1112-les-caracteres-proteges","title":"11.12. Les caract\u00e8res prot\u00e9g\u00e9s","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p> <p>Document ODT / DOCX (MarkDown)</p> <p>Rendu HTML</p> <ul> <li>le code MarkDown a \u00e9t\u00e9 pr\u00e9serv\u00e9\u00a0;</li> </ul>"},{"location":"examen-du-site-html-genere.html#1113-les-tableaux","title":"11.13. Les tableaux","text":"<p>Document ODT / DOCX</p> <p>Rendu HTML</p>"},{"location":"examen-du-site-html-genere.html#1114-notes-de-bas-de-page","title":"11.14. Notes de bas de page","text":""},{"location":"examen-du-site-html-genere.html#1115-anomalies-connues","title":"11.15. Anomalies connues","text":"<p>Certaines anomalies ont \u00e9t\u00e9 rep\u00e9r\u00e9es mais elles peuvent \u00eatre corrig\u00e9es en modifiant l\u2019ODT\u00a0/ DOCX :</p> <ul> <li>les blocs de code doivent \u00eatre suivis d\u2019une ligne vide sinon le bloc de code peut \u00eatre mal rendu. Le cas rep\u00e9r\u00e9 est un code suivi imm\u00e9diatement d\u2019un titre sans \u00eatre s\u00e9par\u00e9 de celui-ci par une ligne vide\u00a0;</li> <li>les listes \u00e0 puces ne peuvent pas voir de bordure inf\u00e9rieure. Pour avoir celle-ci, il faut ajouter une ligne vide derri\u00e8re le dernier \u00e9l\u00e9ment de la liste\u00a0;</li> <li>les listes \u00e0 puces doivent \u00eatre hi\u00e9rarchis\u00e9es. Ainsi une liste de niveau 2 doit \u00eatre toujours incluse dans une liste de niveau 1, sinon la liste de niveau 2 est rendue comme \u00e9tant du code\u00a0;</li> </ul> <p>Au fil des versions du convertisseur, certaines de ces anomalies sont appel\u00e9es \u00e0 dispara\u00eetre. Les trois pr\u00e9c\u00e9dentes sont \u00e9vitables en corrigeant le document source.</p>"},{"location":"examen-du-site-html-genere.html#1116-autres-cas","title":"11.16. Autres cas","text":"<p>Si votre document utilise d\u2019autres particularit\u00e9s que celles \u00e9voqu\u00e9es pr\u00e9c\u00e9demment, il est hautement probable que celles-ci ne seront pas prises en compte par le convertisseur Gemini\u00a0/ ChatGPT . Que faire alors\u00a0? Vous pouvez faire part de votre nouvelle demande \u00e0 l\u2019une des IA en lui donnant le convertisseur actuel\u00a0:</p> <ul> <li>En [1], je joins le convertisseur de ce document\u00a0;</li> <li>En [2], je fais ma nouvelle demande\u00a0;</li> </ul> <p>Vous allez partir probablement pour de nombreuses it\u00e9rations. Lorsqu\u2019une version est stable, notez son num\u00e9ro pour pouvoir le redonner \u00e0 l\u2019IA en cas de r\u00e9gression. Il est conseill\u00e9 \u00e9galement de faire une copie de chaque version stable. Un inconv\u00e9nient majeur des deux IA est qu\u2019elles r\u00e9gressent assez facilement. Il suffit de lui demander une nouvelle fonctionnalit\u00e9 pour que l\u2019IA casse le code qui marchait auparavant. D\u2019o\u00f9 l\u2019importance de noter le num\u00e9ro de version des versions stables afin de pouvoir y revenir. En janvier 2026, il m\u2019a sembl\u00e9 que ChatGPT 5.2 avait moins tendance \u00e0 r\u00e9gresser que Gemini 3.</p>"},{"location":"heberger-le-site-html-sur-github.html","title":"12. H\u00e9berger le site HTML sur GitHub","text":""},{"location":"heberger-le-site-html-sur-github.html#12-heberger-le-site-html-sur-github","title":"12. H\u00e9berger le site HTML sur GitHub","text":"<p>C\u2019est Gemini lui-m\u00eame qui m\u2019a propos\u00e9 d\u2019h\u00e9berger le site HTML produit par ses deux scripts sur GitHub<sup>1</sup>. Je ne savais pas que c\u2019\u00e9tait possible. GitHub est un site qui h\u00e9berge des projets de d\u00e9veloppement. Y exporter des cours de programmation para\u00eet naturel.</p> <p>Il faut d\u2019abord que vous ayez un compte GitHub. Si besoin est, cr\u00e9ez le.</p> <p>Connectez-vous \u00e0 votre compte GitHub\u00a0:</p> <ul> <li>En [2], vos d\u00e9p\u00f4ts (repository) existants si vous en avez\u00a0;</li> <li>En [3], cr\u00e9ez un nouveau d\u00e9p\u00f4t GitHub\u00a0;</li> </ul> <ul> <li>En [1], utilisez le nom que vous avez mis dans [config.py]\u00a0:</li> </ul> <pre><code>\n  \"repo_url\": \"https://github.com/stahe/word-odt-vers-html-janv-2026\",\n</code></pre> <ul> <li>En [2], vous pouvez \u00e9galement mettre la m\u00eame chose que dans [config.py]\u00a0:</li> </ul> <pre><code>  \"site_description\": \"Convertir un document Word ou ODT vers un site statique HTML \u00e0 l'aide de les IA Gemini 3 et ChatGPT 5.2\",\n</code></pre> <ul> <li>En [3], validez la cr\u00e9ation de votre d\u00e9p\u00f4t GitHub\u00a0;</li> </ul> <p>Il est conseill\u00e9 pour chaque d\u00e9p\u00f4t GitHub de cr\u00e9er un fichier [README.md] qui sera affich\u00e9 \u00e0 la place de l\u2019\u00e9cran ci-dessus. Il doit \u00eatre \u00e9crit en MarkDown, un truc pas simple. On va donc \u00e9crire un fichier texte avec dedans ce qu\u2019on voudrait voir dans le README. Puis on demandera \u00e0 l\u2019IA de nous donner le README.md qui correspond.</p> <p>Le fichier texte [readme.txt] sera le suivant\u00a0:</p> <pre><code>On se propose dans cet article de mettre \u00e0 disposition du lecteur un convertisseur Python de documents Word ou ODT vers un site statique HTML.\n\nCe convertisseur a \u00e9t\u00e9 construit par l\u2019IA Gemini 3.\n\nLorsque le document ODT convient, le convertisseur produit un site HTML via MkDocs qui a l'aspect professionnel des sites produits par Pandoc.\n\nJ\u2019ai utilis\u00e9  Gemini 3 avec un abonnement pro.\n</code></pre> <p>Le prompt \u00e0 Gemini est alors le suivant\u00a0:</p> <ul> <li>En [1], le fichier attach\u00e9 [readme.txt]\u00a0;</li> <li>En [2], le prompt\u00a0;</li> </ul> <p>Copiez la r\u00e9ponse que Gemini vous donne dans le fichier [README.md] de votre dossier de travail. Voici la r\u00e9ponse que Gemini m\u2019a donn\u00e9e\u00a0:</p> <pre><code># Convertisseur Word/ODT vers Site HTML (MkDocs)\n\n\ud83d\udd17 **[Voir le site de d\u00e9monstration g\u00e9n\u00e9r\u00e9](https://stahe.github.io/word-odt-vers-html-janv-2026/)**\n\n---\n\n## \ud83d\udcdd Description\n\nOn se propose dans ce projet de mettre \u00e0 disposition du lecteur un convertisseur Python de documents Word ou ODT vers un site statique HTML.\n\nLorsque le document ODT convient, le convertisseur produit un site HTML via **MkDocs** qui a l'aspect professionnel des sites produits par Pandoc.\n\n## \ud83e\udd16 Contexte de cr\u00e9ation\n\nCe convertisseur a \u00e9t\u00e9 enti\u00e8rement construit par l\u2019IA **Gemini 3** (avec un abonnement pro). Il est le r\u00e9sultat d'it\u00e9rations successives pour g\u00e9rer finement la structure des documents ODT (OpenDocument Text).\n\n## \u2728 Fonctionnalit\u00e9s\n\nLe script `convert.py` effectue les actions suivantes :\n\n* **Conversion ODT vers Markdown** : Analyse le fichier `.odt` (XML) pour en extraire la structure.\n* **Gestion des Titres** : G\u00e9n\u00e8re automatiquement la Table des Mati\u00e8res (TOC) et la navigation lat\u00e9rale.\n* **Blocs de Code** : D\u00e9tection automatique des langages, coloration syntaxique et **gestion pr\u00e9cise de la num\u00e9rotation des lignes** (attributs `start-value`).\n* **Listes** : Support des listes \u00e0 puces et num\u00e9rot\u00e9es avec indentation correcte.\n* **Mise en forme** : Support du *gras*, *italique*, *soulign\u00e9* et du *surlignage* (avec respect des couleurs d'origine).\n* **Images** : Extraction et int\u00e9gration automatique des images contenues dans le document.\n* **Configuration** : Personnalisation via un fichier `config.py` (Bas de page, Google Analytics, etc.).\n\n## \ud83d\ude80 Installation\n\n### Pr\u00e9requis\n\n* Python 3.x\n* Les biblioth\u00e8ques suivantes :\n\n```bash\npip install odfpy unidecode mkdocs mkdocs-material\n\n```\n\n### Structure du projet\n\nAssurez-vous d'avoir les fichiers suivants :\n\n* `convert.py` : Le script de conversion.\n* `config.py` : Votre fichier de configuration.\n* `votre-document.odt` : Le document source.\n\n## \ud83d\udcbb Utilisation\n\n1. **Conversion**\nLancez le script en indiquant le fichier ODT source et le fichier de configuration :\n```bash\npython convert.py votre-document.odt config.py\n\n```\n\n\n*Cela va g\u00e9n\u00e9rer un dossier `docs/` contenant les fichiers Markdown et un fichier `mkdocs.yml`.*\n2. **Pr\u00e9visualisation**\nPour voir le site en local :\n```bash\nmkdocs serve\n\n```\n\n\n3. **G\u00e9n\u00e9ration**\nPour construire le site statique (dossier `site/`) :\n```bash\nmkdocs build\n\n```\n\n\n\n## \u2699\ufe0f Configuration (`config.py`)\n\nLe fichier `config.py` permet de contr\u00f4ler l'apparence du site :\n\n* **mkdocs** : Param\u00e8tres g\u00e9n\u00e9raux du site (titre, description, th\u00e8me Material).\n* **footer** : Code HTML complet pour personnaliser le pied de page.\n* **code** : R\u00e8gles de d\u00e9tection des langages pour la coloration syntaxique.\n* **extra** : Configuration de Google Analytics (GA4).\n\n## \ud83d\udcc4 Licence\n\nCe cours tutoriel \u00e9crit par **Serge Tah\u00e9** est mis \u00e0 disposition du public selon les termes de la :\n*Licence Creative Commons Attribution \u2013 Pas d\u2019Utilisation Commerciale \u2013 Partage dans les M\u00eames Conditions 3.0 non transpos\u00e9.*\n</code></pre> <p>C\u2019est un README tr\u00e8s complet qu\u2019il m\u2019a fourni. C\u2019est parce que Gemini conna\u00eet tr\u00e8s bien ce projet sur lequel on travaille depuis des semaines. Vous aurez sans doute un [README.md] moins d\u00e9taill\u00e9.</p> <p>Maintenant revenons \u00e0 notre dossier de travail\u00a0:</p> <ul> <li>En [2], le fichier README que vous venez de modifier\u00a0;</li> <li>En [1], le fichier [deploy.txt] explique comment exporter votre site HTML sur votre d\u00e9p\u00f4t GitHub\u00a0;</li> </ul> <p>Le contenu du fichier [deploy.txt] est le suivant\u00a0:</p> <pre><code>git init\ngit branch -M main\n# v\u00e9rifier .gitignore avant !\ngit add .\n# premier commit\ngit commit -m \"Initial commit: Source MkDocs\"\ngit remote add origin https://github.com/stahe/word-odt-vers-html-janv-2026.git\ngit push -u origin main\npython -m mkdocs gh-deploy\n</code></pre> <p>C\u2019est la suite de commandes qui va exporter votre site HTML sur votre d\u00e9p\u00f4t GitHub. Vous aurez \u00e0 modifier la ligne 7 avec l\u2019URL de votre propre d\u00e9p\u00f4t GitHub, pr\u00e9sente dans le fichier [config.py]\u00a0:</p> <pre><code>    \"repo_url\": \"https://github.com/stahe/word-odt-vers-html-janv-2026\",\n</code></pre> <p>Vous devez v\u00e9rifier \u00e9galement une autre URL pr\u00e9sente dans le fichier [robots.txt]\u00a0:</p> <p>Le contenu du fichier [robots.txt] est le suivant\u00a0:</p> <pre><code>\nUser-agent: *\nAllow: /\nSitemap: https://stahe.github.io/word-odt-vers-html-janv-2026/sitemap.xml\n</code></pre> <p>En ligne 3, mettez l\u2019URL de votre site, la m\u00eame que dans le fichier [config.py]\u00a0:</p> <pre><code>\n        # URL de publication du site (ex: GitHub Pages)\n        \"site_url\": \"https://stahe.github.io/word-odt-vers-html-janv-2026/\",\n</code></pre> <p>Le fichier [robots.txt] n\u2019est pas utilis\u00e9 lors de la construction locale du site, mais il le sera lorsqu\u2019il sera h\u00e9berg\u00e9 sur GitHub.</p> <p>La suite de commandes de [deploy.txt] utilise un logiciel appel\u00e9 Git. Vous devez l\u2019installer [Git - Install for Windows].</p> <p>Ceci fait, v\u00e9rifiez le fichier s\u2019appelant [.gitignore] dans votre dossier de travail. Il indique \u00e0 Git les fichiers qu\u2019il doit ignorer. Mon fichier [.gitignore] est le suivant\u00a0:</p> <pre><code># 1. On ignore TOUS les fichiers et dossiers du projet\n*\n\n# 3. On fait une exception (!) pour le seul fichier que vous voulez garder\n!README.md\n</code></pre> <p>Il est extr\u00eamement simple. On ignore tous les fichiers (ligne 2) sauf le fichier [README.md] (ligne 5). GitHub est fait pour h\u00e9berger les projets de d\u00e9veloppement. C\u2019est en g\u00e9n\u00e9ral tout le projet de d\u00e9veloppement qui est export\u00e9 sur GitHub. Nous on cherche simplement \u00e0 exporter un site HTML, pas un projet de d\u00e9veloppement. Le seul fichier qu\u2019on veut exporter sur notre d\u00e9p\u00f4t GitHub est le fichier [README.md] qui explique aux visiteurs ce que contient notre site HTML.</p> <p>Maintenant, dans votre terminal, tapez la s\u00e9quence de commandes suivantes dans l\u2019ordre indiqu\u00e9 par [deploy.txt] en allant jusqu\u2019\u00e0 la commande 8. N\u2019ex\u00e9cutez pas la commande 9 pour l\u2019instant.</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git init\nInitialized empty Git repository in C:/Data/st-2025/GitHub Pages/word-odt-vers-html/v2/.git/\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git branch -M main\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git add .\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git commit -m \"Initial commit: Source MkDocs\"\n[main (root-commit) 7cba5b1] Initial commit: Source MkDocs\n 1 file changed, 89 insertions(+)\n create mode 100644 README.md\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git remote add origin https://github.com/stahe/word-odt-vers-html-janv-2026.git\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; git push -u origin main\nEnumerating objects: 3, done.\nCounting objects: 100% (3/3), done.\nDelta compression using up to 8 threads\nCompressing objects: 100% (2/2), done.\nWriting objects: 100% (3/3), 1.70 KiB | 1.70 MiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0), pack-reused 0 (from 0)\nTo https://github.com/stahe/word-odt-vers-html-janv-2026.git\n * [new branch]      main -&gt; main\nbranch 'main' set up to track 'origin/main'.\n</code></pre> <p>Faites un Ctrl-clic sur l\u2019URL de la ligne 17. Cela va vous emmener sur votre d\u00e9p\u00f4t GitHub\u00a0:</p> <ul> <li>En [1], l\u2019URL de votre d\u00e9p\u00f4t GitHub\u00a0;</li> <li>En [2], le nouveau README.md\u00a0;</li> </ul> <p>Maintenant passons \u00e0 la commande 9 du fichier [deploy.txt]. C\u2019est elle qui exporte le site HTML sur GitHub\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python -m mkdocs gh-deploy\nINFO    -  Cleaning site directory\nINFO    -  Building documentation to directory: C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2\\site\nINFO    -  Doc file 'les-exemples.md' contains a link '#_Les_exemples', but there is no such anchor on this page.\nINFO    -  Documentation built in 1.79 seconds\nWARNING -  Version check skipped: No version specified in previous deployment.\nINFO    -  Copying 'C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2\\site' to 'gh-pages' branch and pushing to GitHub.\nEnumerating objects: 91, done.\nCounting objects: 100% (91/91), done.\nDelta compression using up to 8 threads\nCompressing objects: 100% (85/85), done.\nWriting objects: 100% (91/91), 1.64 MiB | 2.01 MiB/s, done.\nTotal 91 (delta 9), reused 0 (delta 0), pack-reused 0 (from 0)\nremote: Resolving deltas: 100% (9/9), done.\nremote: \nremote: Create a pull request for 'gh-pages' on GitHub by visiting:\nremote:      https://github.com/stahe/word-odt-vers-html-janv-2026/pull/new/gh-pages\nremote: \nTo https://github.com/stahe/word-odt-vers-html-janv-2026.git\n * [new branch]      gh-pages -&gt; gh-pages\nINFO    -  Your documentation should shortly be available at: https://stahe.github.io/word-odt-vers-html-janv-2026/\n</code></pre> <p>Faites un Ctrl-clic sur l\u2019URL de la ligne 21. Cela va vous amener \u00e0 votre nouveau site HTML sur GitHub\u00a0:</p> <ul> <li>En [1], on voit que vous affichez un site web sur GitHub\u00a0;</li> </ul> <p>Il est extr\u00eamement facile de se tromper dans l\u2019ex\u00e9cution des commandes de [deploy.txt]. Il est alors difficile de revenir en arri\u00e8re car Git garde la m\u00e9moire de ce qu\u2019on a fait (mal). Pour repartir de z\u00e9ro, visualisez le dossier de travail\u00a0:</p> <ul> <li>En [1], supprimez le dossier [.git]\u00a0;</li> </ul> <p>Revenez ensuite dans PyCharm et recommencez la s\u00e9rie de commandes de [deploy.txt].</p> <p>Que faire si vous modifiez votre Document ODT / DOCX\u00a0? Faites les 3 choses suivantes\u00a0:</p> <ol> <li>convertissez de nouveau votre Document ODT / DOCX avec [convert]\u00a0;</li> <li>construisez le site HTML avec [build]\u00a0;</li> <li>exportez le site HTML sur GitHub avec la commande [python -m mkdocs gh-deploy]. Cette commande suffit tant que vous ne modifiez pas le fichier [README.md]. Si vous modifiez le fichier [README.md], vous aurez un peu plus de commandes \u00e0 \u00e9mettre\u00a0:</li> </ol> <pre><code>git add README.md\n# commit\ngit commit -m \"modif README\"\ngit push -u origin main\npython -m mkdocs gh-deploy\n</code></pre> <p>Si vous avez seulement modifi\u00e9 le README, seules les commandes 1, 3, 4 sont n\u00e9cessaires. La commande 5 est inutile si vous avez d\u00e9j\u00e0 d\u00e9ploy\u00e9 le site HTML et qu\u2019il n\u2019a pas boug\u00e9 depuis.</p> <p>Que faire si vous voulez repartir de z\u00e9ro parce que les choses sont parties en vrille\u00a0? Vous pouvez supprimer votre d\u00e9p\u00f4t GitHub et refaire toutes les op\u00e9rations du chapitre 12. L\u2019option de suppression d\u2019un d\u00e9p\u00f4t GitHub est bien cach\u00e9e\u00a0:</p> <ul> <li>En [1], allez dans les param\u00e8tres de configuration du d\u00e9p\u00f4t\u00a0;</li> </ul> <p>Allez tout en bas de la page des [settings]. Vous y trouverez le bouton pour supprimer votre d\u00e9p\u00f4t [2].</p> <ol> <li> <p>Note de bas de page pour GitHub\u00a0\u21a9</p> </li> </ol>"},{"location":"introduction.html","title":"1. Introduction","text":"<p>Le PDF de ce document est disponible |ICI|.</p> <p>Les convertisseurs Gemini 3 / ChatGPT 5.2 [Word ou ODT \u2192 HTML] sont disponibles |ICI|.</p> <p>Ce document vous donne deux convertisseurs\u00a0:</p> <ul> <li>un convertisseur LibreOffice ODT vers HTML\u00a0;</li> <li>un convertisseur Word DOCX vers HTML\u00a0;</li> </ul> <p>.</p> <p>On se propose dans cet article de mettre \u00e0 disposition du lecteur un convertisseur Python de documents Word ou ODT vers un site statique HTML. Ce convertisseur a \u00e9t\u00e9 construit initialement par l\u2019IA Gemini 3 puis par ChatGPT 5.2. Il a fallu 356 it\u00e9rations \u00e0 ces deux IA pour produire le convertisseur de ce document. Cela a repr\u00e9sent\u00e9 un d\u00e9bogage de plusieurs semaines. Gemini 3 a fait tout le travail au d\u00e9but. Il a fallu d\u2019abord plusieurs dizaines d\u2019it\u00e9rations pour obtenir une premi\u00e8re version \u00e0 peu pr\u00e8s correcte. Puis r\u00e9guli\u00e8rement j\u2019ajoutais un nouveau probl\u00e8me pos\u00e9 par de nouveaux documents ODT. Et l\u00e0, Gemini a souvent r\u00e9gress\u00e9. C\u2019est-\u00e0-dire que ce qui marchait \u00e0 l\u2019\u00e9tape N ne marchait plus aux \u00e9tapes suivantes. J\u2019ai alors proc\u00e9d\u00e9 ainsi\u00a0: d\u00e8s que Gemini produisait un convertisseur qui r\u00e9solvait un de mes probl\u00e8mes, j\u2019en faisais une version de r\u00e9f\u00e9rence et je le disais \u00e0 Gemini. Je sauvegardais cette r\u00e9f\u00e9rence localement. Puis lorsque je voyais Gemini r\u00e9gresser trop longtemps je lui demandais de revenir \u00e0 la derni\u00e8re version de r\u00e9f\u00e9rence connue en la lui donnant. C\u2019est comme \u00e7a que peu \u00e0 peu, on a construit ensemble ce convertisseur\u00a0: moi en lui exprimant ce que je voulais, essentiellement en lui signalant les anomalies que je trouvais dans le site HTML produit, lui en produisant le code demand\u00e9.</p> <p>J\u2019ai utilis\u00e9  Gemini 3 avec une licence pro \u00e0 22 euros /mois et ChapGPT 5.2 de m\u00eame.</p> <p>Gemini / ChatGPT va g\u00e9n\u00e9rer deux scripts Python\u00a0:</p> <ul> <li>[convert] pour convertir le document ODT de LibreOffice ou le document DOCX de Word en site MkDocs\u00a0;</li> <li>[build] pour convertir le site MkDocs en site HTML statique\u00a0; </li> </ul> <p>Je n\u2019ai jamais regard\u00e9 le code g\u00e9n\u00e9r\u00e9. Je voulais les consid\u00e9rer comme des bo\u00eetes noires. Il n\u2019y a pas besoin d\u2019\u00eatre un d\u00e9veloppeur Python pour suivre ce tutoriel ni m\u00eame un d\u00e9veloppeur tout court.</p> <p>En proposant des am\u00e9liorations du convertisseur \u00e0 l\u2019IA Gemini 3, celle-ci s\u2019est parfois bloqu\u00e9e. Elle n\u2019arrivait pas \u00e0 faire les am\u00e9liorations demand\u00e9es. On en \u00e9tait alors \u00e0 la version stable V316. Pour pouvoir avancer, j\u2019ai alors donn\u00e9 cette version op\u00e9rationnelle \u00e0 ChatGPT 5.2 en lui demandant les am\u00e9liorations d\u00e9sir\u00e9es. ChatGPT a correctement modifi\u00e9 le code de Gemini pour satisfaire mes nouvelles demandes. C\u2019est pourquoi je consid\u00e8re que ce sont ces deux IA qui ont g\u00e9n\u00e9r\u00e9 le convertisseur.</p> <p>Par la suite j\u2019ai continu\u00e9 \u00e0 utiliser cette technique. Lorsqu\u2019une IA bloquait sur une fonctionnalit\u00e9, je donnais \u00e0 l\u2019autre IA la derni\u00e8re version stable connue.</p> <p>Les deux IA ont des m\u00e9thodes diff\u00e9rentes pour d\u00e9livrer le code Python demand\u00e9\u00a0:</p> <ul> <li>Gemini donne le code du script g\u00e9n\u00e9r\u00e9 sur la page d\u2019interrogation. Il faut ensuite copier / coller ce code\u00a0;</li> <li>ChatGPT propose un lien de t\u00e9l\u00e9chargement du script g\u00e9n\u00e9r\u00e9\u00a0;</li> </ul> <p>Au-del\u00e0 de 1000 lignes de code g\u00e9n\u00e9r\u00e9 Gemini a montr\u00e9 de s\u00e9v\u00e8res faiblesses. A cause de contraintes techniques propres \u00e0 cette IA, celle-ci n\u2019arrivait pas \u00e0 afficher, dans la page d\u2019interrogation, la totalit\u00e9 du code g\u00e9n\u00e9r\u00e9. Tr\u00e8s souvent il manquait des lignes de code. A cause de cette contrainte, \u00e0 partir d\u2019un moment il n\u2019a plus \u00e9t\u00e9 possible d\u2019utiliser Gemini 3. Et c\u2019est donc ChatGPT 5.2 qui a termin\u00e9 l\u2019\u00e9criture du script.</p> <p>C\u2019est \u00e9galement ChatGPT qui a g\u00e9n\u00e9r\u00e9 le convertisseur Word vers HTML. Je lui ai donn\u00e9 le convertisseur ODT vers HTML qui marchait et lui ai demand\u00e9 de l\u2019adapter pour un document Word. Il l\u2019a fait en 18 it\u00e9rations. C\u2019est une constante de ces deux IA\u00a0: elles comprennent tr\u00e8s bien les scripts Python qu\u2019on leur donne et peuvent y apporter des am\u00e9liorations. Pour moi c\u2019est la meilleure fa\u00e7on de travailler avec elles.</p>"},{"location":"le-dossier-de-travail-du-convertisseur.html","title":"6. Le dossier de travail du convertisseur","text":"<p>Vous pouvez t\u00e9l\u00e9charger le dossier de travail |ICI|.</p> <p>Le dossier de travail est le suivant\u00a0:</p> <ul> <li>Nous allons ignorer pour l\u2019instant les fichiers suivants [.gitignore, deploy.txt, google*.html, README.md, robots.txt, deploy.txt]. Ce sont des fichiers qui nous serviront au d\u00e9ploiement sur GitHub du site HTML g\u00e9n\u00e9r\u00e9 localement\u00a0;</li> <li>[prompt User.txt] est le prompt avec lequel j\u2019ai commenc\u00e9 les it\u00e9rations avec Gemini\u00a0;</li> <li>Le fichier [word-odt-vers-html-janv-2026.odt] est le document ODT de cet article. Il est converti en HTML par le script [convert_odt_v356.py]\u00a0;</li> <li>Le fichier [word-odt-vers-html-janv-2026.docx] est le document DOCX de ce m\u00eame article. Il est converti en HTML par le script [convert_docx_v18.py]\u00a0;</li> <li>Les scripts [convert*.py] et [build.py] sont les deux scripts Python g\u00e9n\u00e9r\u00e9s par les IA\u00a0;<ul> <li>[convert*] convertit un document ODT ou DOCX en site [MkDocs]. Un site MkDocs est un site statique dont les pages sont \u00e9crites selon la syntaxe [MarkDown]. [MkDocs] fournit un serveur capable d\u2019afficher les sites MkDocs\u00a0;</li> <li>[build] convertit le site MkDocs en site statique HTML standard. A la fin de cette conversion, il ouvre un navigateur pour afficher la racine du site\u00a0;</li> </ul> </li> </ul> <p>A aucun moment nous ne regarderons le code Python g\u00e9n\u00e9r\u00e9. On consid\u00e9rera les deux scripts comme deux bo\u00eetes noires. A aucun moment je n\u2019ai modifi\u00e9 du code \u00e0 la main. J\u2019ai toujours demand\u00e9 \u00e0 Gemini / ChatGPT de corriger lui-m\u00eame son script. C\u2019est pourquoi il n\u2019est pas n\u00e9cessaire de conna\u00eetre Python pour utiliser le convertisseur.</p> <ul> <li>[config.py] est un fichier de configuration pour les scripts [convert*]. Au d\u00e9part [convert*] n\u2019avait pas de fichier de configuration. Puis en changeant de documents \u00e0 convertir, je me suis aper\u00e7u peu \u00e0 peu qu\u2019il y avait des \u00e9l\u00e9ments que je demandais \u00e0 l\u2019IA de g\u00e9n\u00e9rer (par exemple le nom du site qui change pour chaque document) qui seraient mieux plac\u00e9s dans un fichier de configuration que l\u2019utilisateur pourrait modifier lui-m\u00eame. Je l\u2019ai construit lui aussi par it\u00e9rations avec l\u2019IA\u00a0;</li> </ul>"},{"location":"le-fichier-de-configuration-des-convertisseurs.html","title":"7. Le fichier de configuration des convertisseurs","text":"<p>Le fichier de configuration [config*.py] rassemble les informations qui peuvent changer d\u2019un document \u00e0 l\u2019autre. Il commence ainsi\u00a0:</p> <pre><code>\nconfig = {\n    # -------------------------------------------------------------------------\n    # Configuration MkDocs\n    # -------------------------------------------------------------------------\n    \"mkdocs\": {\n        # Titre du site qui appara\u00eetra dans l'onglet du navigateur\n        \"site_name\": \"Convertir un document Word ou ODT vers un site statique HTML \u00e0 l'aide de l'IA Gemini 3\",\n\n        # URL de publication du site (ex: GitHub Pages)\n        \"site_url\": \"https://stahe.github.io/word-odt-vers-html-janv-2026/\",\n\n        # M\u00e9ta-description pour le r\u00e9f\u00e9rencement (SEO)\n        \"site_description\": \"Convertir un document Word ou ODT vers un site statique HTML \u00e0 l'aide de l'IA Gemini 3\",\n\n        # Auteur du site\n        \"site_author\": \"Serge Tah\u00e9\",\n\n        # Lien vers le d\u00e9p\u00f4t de code source (ic\u00f4ne GitHub en haut \u00e0 droite)\n        \"repo_url\": \"https://stahe.github.io/word-odt-vers-html-janv-2026\",\n        \"repo_name\": \"GitHub\",\n</code></pre> <ul> <li>ligne 1\u00a0: le fichier de configuration est un script Python. Il d\u00e9finit une unique variable [config]. Celle-ci est un dictionnaire qui va contenir toutes les valeurs de la configuration\u00a0;</li> <li>ligne 5\u00a0: le dictionnaire [mkdocs] va configurer le fichier [mkdocs.yml] g\u00e9n\u00e9r\u00e9 par le convertissseur Gemini / ChatGPT. Ce fichier sert ensuite au script [build] pour construire un site HTML \u00e0 partir du site MkDocs g\u00e9n\u00e9r\u00e9 par le convertisseur\u00a0;</li> <li>lignes 5-20\u00a0: configurent le site GitHub qui va h\u00e9berger le site HTML cr\u00e9\u00e9 \u00e0 partir du document ODT / DOCX (cf paragraphe 12)</li> </ul> <p>Le fichier de configuration [config.py] se poursuit ainsi\u00a0:</p> <pre><code>\n        # Important : \u00e0 False pour que les liens fonctionnent correctement sur GitHub Pages\n        # (\u00e9vite les liens du type dossier/ au lieu de dossier/index.html)\n        \"use_directory_urls\": False,\n\n        # Configuration du th\u00e8me Material pour MkDocs\n        \"theme\": {\n            \"name\": \"material\",\n            # Dossier contenant les surcharges (footer personnalis\u00e9, etc.)\n            \"custom_dir\": \"overrides\",\n\n            # Fonctionnalit\u00e9s de navigation activ\u00e9es\n            \"features\": [\n                \"navigation.sections\",  # Regroupe les sections dans le menu\n                \"navigation.indexes\",  # Permet de cliquer sur le titre de section\n                \"navigation.expand\",  # Ouvre les menus par d\u00e9faut\n                \"toc.integrate\",  # Int\u00e8gre la table des mati\u00e8res \u00e0 gauche (si support\u00e9)\n                \"navigation.top\"  # Bouton \"Retour en haut\"\n            ],\n\n            # Palette de couleurs (Mode Clair / Mode Sombre)\n            \"palette\": [\n                {\n                    \"media\": \"(prefers-color-scheme: light)\",\n                    \"scheme\": \"default\",\n                    \"primary\": \"teal\",\n                    \"accent\": \"purple\",\n                    \"toggle\": {\n                        \"icon\": \"material/brightness-7\",\n                        \"name\": \"Passer au mode sombre\"\n                    }\n                },\n                {\n                    \"media\": \"(prefers-color-scheme: dark)\",\n                    \"scheme\": \"slate\",\n                    \"primary\": \"teal\",\n                    \"accent\": \"purple\",\n                    \"toggle\": {\n                        \"icon\": \"material/brightness-4\",\n                        \"name\": \"Passer au mode clair\"\n                    }\n                }\n            ]\n        },\n</code></pre> <ul> <li>ligne 23\u00a0: cette ligne est importante. Si elle est absente, au lieu d\u2019afficher une page HTML, le navigateur ouvrira le dossier de cette page\u00a0;</li> <li>ligne 26\u00a0: MkDocs propose plusieurs th\u00e8mes pour un site MkDocs / HTML. Ici nous avons choisi le th\u00e8me \u00ab\u00a0material\u00a0\u00bb, ligne 27\u00a0;</li> <li>lignes 31-38\u00a0: configuration de la navigation dans le site. Celle-ci se fera \u00e0 l\u2019aide d\u2019une table des mati\u00e8res situ\u00e9e dans la colonne de gauche de la page affich\u00e9e (ligne 36)\u00a0;</li> <li>lignes 40-63\u00a0: d\u00e9finissent deux palettes de couleurs\u00a0: le mode clair (lignes 43-49) ou le mode sombre (lignes 52-61). Une ic\u00f4ne dans la barre sup\u00e9rieure des pages affich\u00e9es permet de passer de l\u2019un \u00e0 l\u2019autre\u00a0;</li> </ul> <p>La suite du fichier de configuration est la suivante\u00a0:</p> <pre><code>\n        # Extensions Markdown utilis\u00e9es pour enrichir le contenu\n        \"markdown_extensions\": [\n            \"admonition\",  # Blocs d'avertissement/info\n            \"attr_list\",  # Attributs CSS personnalis\u00e9s {: .class }\n            \"pymdownx.superfences\",  # Blocs de code avanc\u00e9s\n            \"pymdownx.mark\",  # Surlignage ==texte==\n            {\n                \"pymdownx.highlight\": {\n                    \"anchor_linenums\": True,\n                    \"linenums\": None  # La num\u00e9rotation est g\u00e9r\u00e9e dynamiquement par le script\n                }\n            },\n            \"md_in_html\",  # Autorise le Markdown dans les balises HTML (crucial pour les listes et tableaux)\n            \"footnotes\"  # Notes de bas de page [^1]\n        ],\n</code></pre> <ul> <li>lignes 64-78\u00a0: des extensions au langage MarkDown utilis\u00e9 par MkDocs. Ces extensions ont \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9es par Gemini \u00e0 la suite de certaines de mes demandes\u00a0;</li> </ul> <p>La suite du fichier de configuration est la suivante\u00a0:</p> <pre><code>\n        # Scripts et CSS additionnels\n        \"extra_javascript\": [\n            \"javascripts/focus.js\"  # Script pour le mode \"Focus\" (plein \u00e9cran)\n        ],\n        \"extra_css\": [\n            \"stylesheets/focus.css\"\n        ]\n    },\n</code></pre> <ul> <li>ligne 81\u00a0: le script [focus.js] est un script Javascript g\u00e9n\u00e9r\u00e9 par Gemini. Il est associ\u00e9 au bouton de la barre sup\u00e9rieure du site pour afficher ou cacher la table des mati\u00e8res\u00a0;</li> <li>ligne 84\u00a0: le CSS utilis\u00e9 par ce bouton\u00a0;</li> </ul> <p>La suite du fichier de configuration est la suivante\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # Pied de page (Footer)\n    # -------------------------------------------------------------------------\n    \"footer\": (\n        \"{% block footer %}\\n\"\n        \"  &lt;div class=\\\"md-footer-meta md-typeset\\\"&gt;\\n\"\n        \"    &lt;div class=\\\"md-footer-meta__inner\\\"&gt;\\n\\n\"\n        \"      &lt;div&gt;\\n\"\n        \"        &lt;a href=\\\"https://tahe.developpez.com\\\" target=\\\"_blank\\\"&gt;\\n\"\n        \"          https://tahe.developpez.com\\n\"\n        \"        &lt;/a&gt;\\n\"\n        \"        &lt;br&gt;\\n\"\n        \"        Ce cours-tutoriel \u00e9crit par &lt;strong&gt;Serge Tah\u00e9&lt;/strong&gt; est mis \u00e0 disposition du public selon les termes de la\\n\"\n        \"        &lt;em&gt;Licence Creative Commons Attribution \u2013 Pas d\u2019Utilisation Commerciale \u2013\\n\"\n        \"        Partage dans les M\u00eames Conditions 3.0 non transpos\u00e9&lt;/em&gt;.\\n\"\n        \"      &lt;/div&gt;\\n\\n\"\n        \"    &lt;/div&gt;\\n\"\n        \"  &lt;/div&gt;\\n\"\n        \"{% endblock %}\"\n    ),\n</code></pre> <ul> <li>lignes 87-106\u00a0: la d\u00e9finition du pied de page du site HTML. A \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9 par Gemini \u00e0 partir d\u2019un exemple texte que je lui ai donn\u00e9\u00a0;</li> </ul> <p>La suite du fichier de configuration est la suivante\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # Configuration suppl\u00e9mentaire (Analytics, etc.)\n    # -------------------------------------------------------------------------\n    \"extra\": {\n        \"analytics\": {\n            \"provider\": \"google\",\n            \"property\": \"G-XXXXXXXX\"\n        }\n    },\n\n    # -------------------------------------------------------------------------\n    # D\u00e9tection du Titre du Document\n    # -------------------------------------------------------------------------\n    \"document_title\": {\n        # Styles ODT \u00e0 consid\u00e9rer comme le titre principal du document (H1 global)\n        \"style_names\": [\n            \"P1\"\n        ],\n        # CSS appliqu\u00e9 \u00e0 ce titre dans le Markdown g\u00e9n\u00e9r\u00e9\n        \"css\": \"font-size: 28px; font-weight: bold; margin-bottom: 1em; line-height: 1.2; color: #2c3e50;\"\n    },\n</code></pre> <ul> <li>lignes 110-115\u00a0: d\u00e9finition du marqueur Google Analytics (GA) qui va permettre de suivre les visites du site\u00a0;</li> <li>ligne 113\u00a0: mettez-l\u00e0 votre marqueur GA\u00a0;</li> <li>lignes 120-127\u00a0: le style du titre du document, celui qui est pr\u00e9sent dans le document ODT /DOCX avant le premier titre de niveau 1. Le style indiqu\u00e9 ligne 123 change avec chaque Document ODT. En revanche il peut \u00eatre constant (\u2018Titre\u2019) pour les documents DOCX. Par d\u00e9faut, le convertisseur logue les styles de tous les paragraphes du document ODT / DOCX qui pr\u00e9c\u00e8de le premier titre de niveau 1. Il faut donc faire une premi\u00e8re ex\u00e9cution, rep\u00e9rer le style du paragraphe qu\u2019on veut mettre en titre, puis mettre ce style ligne 123\u00a0;</li> <li>ligne 126\u00a0: le style CSS que vous voulez donner au titre du document. Ce titre est dans la page \u00ab\u00a0Accueil\u00a0\u00bb, la premi\u00e8re page affich\u00e9e lorsque le site s\u2019ouvre\u00a0;</li> </ul> <p>La suite du fichier de configuration est la suivante\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # Gestion du Code Source\n    # -------------------------------------------------------------------------\n    \"code\": {\n        # Mot-cl\u00e9 dans le style ODT pour identifier un bloc de code\n        \"style_keywords\": [\n            \"code\"\n        ],\n        # Langage par d\u00e9faut si aucune d\u00e9tection ne fonctionne\n        \"default_language\": \"text\",\n\n        # Style visuel du code enrichi (gras/italique/couleur pr\u00e9serv\u00e9s depuis ODT)\n        \"rich_line_height\": \"20px\",\n        \"rich_font_family\": \"Consolas, 'Courier New', monospace\",\n        \"rich_font_size\": \"15px\",\n\n        # R\u00e8gles de d\u00e9tection automatique du langage bas\u00e9 sur le contenu\n        \"detection_rules\": {\n            \"csharp\": [\n                \"using\", \"Console.WriteLine\", \"public static void Main\", \"WebMethod\",\n                \"TryParse\", \"EventArgs\", \"String.Format\", \"System.Web.Services\"\n            ],\n            \"java\": [\n                \"System.out.println\", \"public static void main(String\", \"package\",\n                \"JUnitTest\", \"Class.forName\", \"PreparedStatement\", \"private static void\",\n                \"private void\", \"getAgendaMedecinJour\", \"@PostConstruct\", \"@ResponseBody\",\n                \"@RequestMapping\", \"getMedecin\", \"@Entity\", \"@Autowired\", \"@Bean\",\n                \"Serializable\", \"getClient\", \"getCreneau\", \"getRv\", \"PostAjouterRv\",\n                \"PostSupprimerRv\", \"@EnableJpaRepositories\", \"@Component\", \"getAgendaMedecinJour\",\n                \"getResponse\", \"getMessagesForException\", \"getBase64\", \"ajouterRv\",\n                \"Reponse\", \"getPartialViewAgenda\", \"setModelforAgenda\", \"ActionContext\",\n                \"getActionContext\", \"PostLang\", \"PostUser\", \"PostGetAgenda\", \"@NotNull\",\n                \"@EnableAutoConfiguration\", \"HttpSecurity\"\n            ],\n            \"html\": [\n                \"&lt;html&gt;\", \"&lt;/div&gt;\", \"&lt;body&gt;\", \"&lt;script&gt;\", \"href=\", \"&lt;span&gt;\", \"&lt;p&gt;\",\n                \"&lt;h2&gt;\", \"&lt;form\", \"&lt;table\", \"&lt;input\"\n            ],\n            \"sql\": [\n                \"SELECT\", \"INSERT INTO\", \"UPDATE\", \"DELETE FROM\", \"WHERE\",\n                \"CREATE TABLE\", \"AlTER TABLE\"\n            ],\n            \"python\": [\n                \"def\", \"import\", \"print(\", \"from\"\n            ],\n            \"xml\": [\n                \"&lt;?xml\", \"&lt;project\", \"&lt;version&gt;\", \"&lt;configuration&gt;\", \"&lt;build&gt;\",\n                \"&lt;dependency&gt;\", \"&lt;properties&gt;\", \"&lt;configuration&gt;\", \"&lt;start-class&gt;\"\n            ],\n            \"javascript\": [\n                \"use strict\", \"console.log\", \"let\", \"constructor\", \"async\", \"export\"\n            ],\n            \"php\": [\n                \"&lt;?php\", \"declare\", \"require\"\n            ],\n            \"vbscript\": [\n                \"Option\", \"Dim\", \"Explicit\"\n            ]\n        }\n    },\n</code></pre> <ul> <li>lignes 128-187\u00a0: cette configuration est utilis\u00e9e pour les codes en \u00ab\u00a0plain text\u00a0\u00bb qui n\u2019ont pas initialement de coloration syntaxique. Ces lignes visent \u00e0 leur en donner une selon le langage utilis\u00e9 dans le bloc de code. Il est \u00e0 noter que si vos codes sont tous enrichis car provenant d\u2019un IDE tels Eclipse, Visual Studio, ... et que vous n\u2019avez pas de bloc de code \u00ab\u00a0plain text\u00a0\u00bb associ\u00e9 \u00e0 un langage, alors vous n\u2019avez rien \u00e0 mettre dans cette partie de la configuration. Vous pouvez laisser vides les tableaux associ\u00e9s aux langages.</li> <li>lignes 133-135\u00a0: les blocs de code sont rep\u00e9r\u00e9s par leurs styles dans le document ODT / DOCX. Il peut y en avoir plusieurs. Ligne 134, on met tous les mots cl\u00e9s qui permettent de d\u00e9tecter un style de code. Dans mes documents, tous mes styles de code ont le mot \u00ab\u00a0code\u00a0\u00bb dans leur nom. Et aucun autre style n\u2019a ce mot dans son nom. Donc je peux me contenter de mettre un unique mot cl\u00e9. S\u2019il y en a plusieurs on les met en les s\u00e9parant par des virgules ligne 134\u00a0;</li> <li>lignes 145-187\u00a0: les cha\u00eenes de caract\u00e8res qui permettent d\u2019identifier le langage d\u2019un bloc de code.. Certains mots cl\u00e9s peuvent se retrouver dans divers langages. Le convertiseur s\u00e9lectionne le langage pour lequel il a trouv\u00e9 le plus de mots cl\u00e9s. Le principe est simple\u00a0: vous regardez vos codes, s\u00e9lectionnez des mots cl\u00e9s caract\u00e9ristiques et vous les mettez dans ces lignes pour le bon langage. Notez que vous ne pouvez pas mettre n\u2019importe quoi comme nom de langage\u00a0: il faut utiliser les noms reconnus par MkDocs\u00a0;</li> <li>lignes 139-142\u00a0: ces lignes concernent les blocs de code enrichis (gras, italique, soukignage, surlignage, couleur des caract\u00e8res). Ces blocs ne subissent pas le traitement des blocs de code \u00ab\u00a0plain text\u00a0\u00bb. Ils sont rendus \u00e0 l\u2019identique dans le HTML\u00a0;<ul> <li>ligne 140\u00a0: fixe la hauteur de ligne des lignes de code\u00a0;</li> <li>ligne 141\u00a0: fixe la police CSS du bloc de code\u00a0;</li> <li>ligne 142\u00a0: fixe la taille des caract\u00e8res\u00a0;</li> </ul> </li> <li>ligne 137\u00a0: fixe le langage par d\u00e9faut. Dans le cas d\u2019un bloc de code \u00ab\u00a0plain text\u00a0\u00bb, si aucun langage n\u2019est d\u00e9tect\u00e9, le langage par d\u00e9faut sera \u00ab\u00a0text\u00a0\u00bb. Pour MkDocs, cela signifie un bloc de code sans coloration syntaxique. C\u2019est par exemple, le cas de r\u00e9sultats d\u2019ex\u00e9cution\u00a0;</li> </ul> <p>La configuration se termine de la fa\u00e7on suivante\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # Fichiers statiques \u00e0 copier \u00e0 la racine du site\n    # -------------------------------------------------------------------------\n    \"files_to_copy\": [\n        \"googleXXXXXX.html\",\n        \"robots.txt\",\n        \"word-odt-vers-html-janv-2026.pdf\"\n    ],\n\n    # Mode debug : affiche les styles rencontr\u00e9s avant le premier titre\n    \"debug\": True\n}\n</code></pre> <ul> <li>lignes 191-195\u00a0: la liste des fichiers \u00e0 copier \u00e0 la racine du site HTML\u00a0;<ul> <li>lignes 192-193\u00a0: le marqueur Google Analytics du site et le fichier [robots.txt] qui autorise l\u2019exploration du site par les moteurs de recherche\u00a0;</li> <li>ligne 194\u00a0: le PDF de ce document rendu disponible au t\u00e9l\u00e9chargement\u00a0;</li> </ul> </li> <li>ligne 198\u00a0: [debug] \u00e0 True autorise les logs des styles des paragraphes qui pr\u00e9c\u00e8dent le premier titre de niveau 1 du Document ODT / DOCX. Ce sont dans ces logs qu\u2019on trouvera le style exact du paragraphe devant servir de titre dans la page d\u2019accueil du site\u00a0;</li> </ul> <p>Au final, lorsqu\u2019on passe d\u2019un Document ODT / DOCX \u00e0 l\u2019autre, on modifiera les lignes\u00a0[6-20, 127-129, 201] et certaines lignes des cha\u00eenes cl\u00e9s des langages. Le reste ne change pas.</p> <p>D\u2019autres \u00e9l\u00e9ments ont \u00e9t\u00e9 ajout\u00e9s au fichier de configuration dans les derni\u00e8res versions du convertisseur\u00a0:</p> <p>Bouton [Copier]</p> <p>Sur les blocs de code enrichi ainsi que sur les blocs de code \u00ab\u00a0plain text\u00a0\u00bb contenant un langage reconnu, il y a un bouton [Copier]\u00a0:</p> <p>Ce bouton permet de copier le bloc de code dans le presse-papier. Les num\u00e9ros de ligne ne sont pas inclus. Le comportement de ce bouton est contr\u00f4l\u00e9 par les lignes suivantes du fichier de configuration [config.py]\u00a0:</p> <pre><code>\n        # ---------------------------------------------------------------------\n        # Bouton [Copier] dans les blocs de code (copie dans le presse-papier)\n        # ---------------------------------------------------------------------\n\n        # Active/d\u00e9sactive l'ajout du bouton [Copier] (True = activ\u00e9)\n        \"copy_button\": True,\n\n        # Libell\u00e9 du bouton avant copie\n        \"copy_label\": \"Copier\",\n\n        # Libell\u00e9 temporaire apr\u00e8s une copie r\u00e9ussie\n        \"copy_copied_label\": \"Copi\u00e9\",\n\n        # Si True, le bouton n'appara\u00eet que si le langage du bloc est \"reconnu\"\n        # (par ex. language-java / language-python, etc.)\n        \"copy_only_recognized_language\": True,\n\n        # Seuil minimum de lignes pour afficher le bouton :\n        # - 0  =&gt; pas de seuil (tous les blocs \"langage reconnu\" auront le bouton)\n        # - &gt;0 =&gt; le bloc doit avoir au moins ce nombre de lignes\n        \"copy_min_lines\": 0,\n\n        # Si True, on autorise aussi le bouton sur les blocs Pygments \"color\u00e9s\"\n        # m\u00eame si la classe language-xxx n'est pas explicitement pr\u00e9sente.\n        # Utile pour certains rendus de code (highlighttable) o\u00f9 la coloration existe\n        # mais o\u00f9 le langage n'appara\u00eet pas dans une classe CSS.\n        \"copy_allow_pygments_heuristic\": True,\n\n        # Apparence du bouton [Copier] (CSS inline : uniquement des d\u00e9clarations,\n        # sans accolades). Permet de personnaliser facilement le look.\n        # ---------------------------------------------------------------------\n        # Style \"Material-like\" pour le bouton [Copier]\n        # (CSS inline : uniquement des d\u00e9clarations, sans accolades)\n        # ---------------------------------------------------------------------\n        \"copy_style\": {\n            # Conteneur du bloc de code : n\u00e9cessaire pour positionner le bouton\n            \"container\": \"position: relative;\",\n\n            # Style normal du bouton\n            \"btn\": (\n                \"position:absolute; top:.5rem; right:.5rem; \"\n                \"display:inline-flex; align-items:center; justify-content:center; \"\n                \"gap:.35rem; \"\n                \"padding:.25rem .6rem; \"\n                \"font-size:.72rem; font-weight:600; letter-spacing:.01em; \"\n                \"line-height:1.2; \"\n                \"border-radius:999px; \"\n                \"border:1px solid rgba(0,150,136,.45); \"\n                \"background:rgba(0,150,136,.12); \"\n                \"color:rgb(0,150,136); \"\n                \"box-shadow:0 1px 2px rgba(0,0,0,.10); \"\n                \"backdrop-filter:saturate(180%) blur(6px); \"\n                \"cursor:pointer; user-select:none; \"\n                \"transition:transform .08s ease, box-shadow .12s ease, background .12s ease;\"\n                \"z-index:5;\"\n            ),\n\n            # Survol : un peu plus \u201c\u00e9lev\u00e9\u201d (comme Material)\n            \"btn_hover\": (\n                \"background:rgba(0,150,136,.20); \"\n                \"box-shadow:0 3px 10px rgba(0,0,0,.18); \"\n                \"transform:translateY(-1px);\"\n            ),\n\n            # \u00c9tat \u201ccopi\u00e9\u201d : l\u00e9ger fade\n            \"btn_copied\": \"opacity:.85;\"\n        },\n    },\n</code></pre> <p>Le lecteur suivra les commentaires pour contr\u00f4ler le bouton.</p> <p>Les images</p> <p>De m\u00eame le comportement des images cliquables est contr\u00f4l\u00e9 par le lignes suivantes du fichier de configuration\u00a0:</p> <pre><code>\n   # -------------------------------------------------------------------------\n   # Images : param\u00e8tres d'ombre (zoom / lightbox)\n   # -------------------------------------------------------------------------\n   \"images\": {\n       \"shadow\": {\n           # Active/d\u00e9sactive l'ombre autour des images\n           \"enabled\": True,\n\n           # Rayon d'arrondi appliqu\u00e9 aux images (ex: \"0px\", \"4px\", \"8px\", ...)\n           \"border_radius\": \"8px\",\n\n           # Ombre par d\u00e9faut sur les images \"zoomables\"\n           \"zoomable\": \"0 8px 24px rgba(0,0,0,.28), 0 18px 60px rgba(0,0,0,.20)\",\n\n           # Ombre au survol (hover) des images \"zoomables\"\n           \"zoomable_hover\": \"0 12px 30px rgba(0,0,0,.32), 0 26px 80px rgba(0,0,0,.22)\",\n\n           # Ombre lorsque l'image est affich\u00e9e en grand (lightbox)\n           \"lightbox\": \"0 24px 80px rgba(0,0,0,.65)\",\n       }\n   },\n</code></pre>"},{"location":"le-prompt-initial-a-gemini-3.html","title":"4. Le prompt initial \u00e0 Gemini 3","text":"<p>On suppose ici que le lecteur a une premi\u00e8re connaissance de l\u2019IA Gemini. Si ce n\u2019est pas le cas, il lui est conseill\u00e9 de lire le document [ref1]. Le prompt initial donn\u00e9 \u00e0 Gemini l\u2019a \u00e9t\u00e9 sous la forme du fichier texte [Prompt User.txt] suivant\u00a0:</p> <pre><code>Demandes utilisateur\n\n- cr\u00e9e un script Python [convert] pour cr\u00e9er un site MkDocs avec le th\u00e8me material \u00e0 partir d'un document ODT. Le nom du document ODT sera l'unique argument de convert.\n\n- puis cr\u00e9e un script Python [build] qui exploitera le fichier [mkdocs.yml] cr\u00e9\u00e9 par convert pour cr\u00e9er un site statique HTML\n- \u00e0 la fin, le script [build] affichera l'accueil du site dans un navigateur.\n\n- le site aura deux colonnes ind\u00e9pendantes. Celle de gauche contiendra la table des mati\u00e8res, celle de droite le contenu du document ODT.\n\n- la table des mati\u00e8res reprendra la totalit\u00e9 des titres du document ODT (Titre1, Titre2, Titre3, etc...), leur num\u00e9rotation et leur hi\u00e9rarchie\n\n- les images sont la plupart du temps dans des tableaux et ont \u00e9t\u00e9 redimensionn\u00e9es.\nTu exploreras les tableaux \u00e0 la recherche de ces images et tu respecteras leur redimensionnement.\n\n- il y a des blocs de code dans le document ODT. Ils peuvent \u00eatre rep\u00e9r\u00e9s par leurs styles [Source Code num\u00e9rot\u00e9 r\u00e9sultats, Source Code]\nLes autres attributs du paragraphe de code doivent \u00eatre ignor\u00e9s. Par exemple, si le paragraphe de code est \u00e9galement une liste num\u00e9rot\u00e9e, tu dois ignorer cet attribut.\nTous ces blocs de code doivent \u00eatre trait\u00e9s comme du code dans le site MkDocs. Les lignes de code doivent \u00eatre num\u00e9rot\u00e9es dans le r\u00e9sultat HTML.\n\n- pour tous les blocs de code tu utiliseras la coloration syntaxique de Python.\n\n- tu ne dois pas toucher aux lignes de code. Notamment tu ne dois pas supprimer les indentations ou espaces qui pr\u00e9c\u00e8dent le premier caract\u00e8re de la ligne de code.\n\n- tu dois trouver toutes les listes \u00e0 puces. ODT a plusieurs fa\u00e7ons de les cr\u00e9er. Tu dois toutes les explorer. Les listes de puces sont\nparfois imbriqu\u00e9es les unes dans les autres. Tu dois respecter cette imbrication.\n\n- le titre du site sera \"G\u00e9n\u00e9rer un script Python avec des outils d'IA\"\n\n- tu logueras chaque image extraite du document ODT ainsi que chaque chapitre MkDocs cr\u00e9\u00e9\n\n- tu dois respecter les liens que tu trouves dans le document ODT. Ils doivent rester des liens dans le document HTML g\u00e9n\u00e9r\u00e9.\n\n- tu dois respecter les textes en gras, soulign\u00e9s ou en italiques. ils doivent \u00eatre rendus tels quels dans le document HTML\n</code></pre> <ul> <li>ligne 19\u00a0: le test initial a \u00e9t\u00e9 fait sur un cours publi\u00e9 pr\u00e9c\u00e9demment\u00a0qui contenait des codes Python\u00a0;</li> <li>ce prompt a permis de d\u00e9marrer le chat. Au bout de quelques dizaines d\u2019it\u00e9rations il est devenu obsol\u00e8te\u00a0;</li> </ul>"},{"location":"les-exemples-de-ce-document----.html","title":"2. Les exemples de ce document","text":""},{"location":"les-exemples-de-ce-document----.html#2-les-exemples-de-ce-document","title":"2. Les exemples de ce document","text":"<p>Je voudrais faire un article court. Les interactions entre une IA et un utilisateur sont pr\u00e9sent\u00e9s dans l\u2019article [G\u00e9n\u00e9rer un script Python avec des outils d\u2019IA] que j\u2019appellerais d\u00e9sormais [ref1]. Les interactions avec Gemini et ChatGPT ne seront pr\u00e9sent\u00e9es qu\u2019\u00e0 la marge. De toute fa\u00e7on il \u00e9tait impossible de pr\u00e9senter toutes les it\u00e9rations.</p> <p>Je vais pr\u00e9senter maintenant des exemples des particularit\u00e9s de mes documents ODT / DOCX que le convertisseur Gemini / ChatGPT g\u00e8re correctement. C\u2019est ce propre document que nous proposerons \u00e0 la conversion HTML au script de Gemini / ChatGPT. Nous verrons ce qu\u2019il en fait.</p>"},{"location":"les-exemples-de-ce-document----.html#21-les-listes","title":"2.1. Les listes","text":"<p>Le convertisseur Gemini / ChatGPT sait g\u00e9rer les listes \u00e0 puces et les listes num\u00e9rot\u00e9es\u00a0m\u00eame si elles sont imbriqu\u00e9es :</p> <p></p>"},{"location":"les-exemples-de-ce-document----.html#211-listes-a-puces","title":"2.1.1. Listes \u00e0 puces","text":"<ul> <li>\u00c9l\u00e9ment 1\u00a0;</li> <li>\u00c9l\u00e9ment 2\u00a0:</li> <li>\u00c9l\u00e9ment 3\u00a0;<ul> <li>\u00c9l\u00e9ment 3.1\u00a0;<ul> <li>El\u00e9ment 3.1.1</li> <li>El\u00e9ment 3.1.2<ul> <li>El\u00e9ment 3.1.2.1</li> <li>El\u00e9ment 3.1.2.2</li> </ul> </li> </ul> </li> <li>\u00c9l\u00e9ment 3.2\u00a0;</li> </ul> </li> <li>\u00c9l\u00e9ment 4\u00a0;</li> </ul>"},{"location":"les-exemples-de-ce-document----.html#212-listes-numerotees","title":"2.1.2. Listes num\u00e9rot\u00e9es","text":"<ol> <li>\u00c9l\u00e9ment 1\u00a0;</li> <li>\u00c9l\u00e9ment 2\u00a0;<ol> <li>El\u00e9ment 2.1<ol> <li>El\u00e9ment 2.1.1<ol> <li>El\u00e9ment 2.1.1.1</li> <li>El\u00e9ment 2.1.1.2</li> </ol> </li> <li>El\u00e9ment 2.1.2</li> </ol> </li> <li>El\u00e9ment 2.2</li> </ol> </li> <li>\u00c9l\u00e9ment 3\u00a0;</li> </ol>"},{"location":"les-exemples-de-ce-document----.html#213-listes-mixtes-1","title":"2.1.3. Listes mixtes 1","text":"<ul> <li>\u00c9l\u00e9ment 1\u00a0;</li> <li>\u00c9l\u00e9ment 2\u00a0:</li> <li>\u00c9l\u00e9ment 3\u00a0;<ul> <li>\u00c9l\u00e9ment 3.1\u00a0;<ol> <li>El\u00e9ment 3.1.1</li> <li>El\u00e9ment 3.1.2<ul> <li>El\u00e9ment 3.1.2.1</li> <li>El\u00e9ment 3.1.2.2</li> </ul> </li> </ol> </li> <li>\u00c9l\u00e9ment 3.2\u00a0;</li> </ul> </li> <li>\u00c9l\u00e9ment 4\u00a0;</li> </ul>"},{"location":"les-exemples-de-ce-document----.html#214-listes-mixtes-2","title":"2.1.4. Listes mixtes 2","text":"<ol> <li>\u00c9l\u00e9ment 1\u00a0;</li> <li>\u00c9l\u00e9ment 2\u00a0;<ol> <li>El\u00e9ment 2.1<ol> <li>El\u00e9ment 2.1.1<ul> <li>El\u00e9ment 2.1.1.1</li> <li>El\u00e9ment 2.1.1.2</li> </ul> </li> <li>El\u00e9ment 2.1.2</li> </ol> </li> <li>El\u00e9ment 2.2</li> </ol> </li> <li>\u00c9l\u00e9ment 3\u00a0;</li> </ol>"},{"location":"les-exemples-de-ce-document----.html#22-les-blocs-de-code","title":"2.2. Les blocs de code","text":"<p>Mes cours contiennent beaucoup de blocs de code. Ce sont souvent des codes enrichis (gras, couleurs des mots cl\u00e9s) par les IDE (Eclipse, PyCharm, WebStorm, Netbeans). Ces codes enrichis sont rendus \u00e0 l\u2019identique par le convertisseur.</p> <p>Quand le code n\u2019est pas enrichi (code venant du Bloc-Notes ou Notepad ou \u2026), le convertisseur Gemini / ChatGPT le reconna\u00eet (Java, C#, XML, HTML, \u2026) \u00e0 l\u2019aide de mots cl\u00e9s du langage mis dans un fichier de configuration. Lorsqu\u2019il reconna\u00eet un langage il ins\u00e8re un marqueur (fence) pour MkDocs afin que celui-ci adapte la coloration syntaxique du code au langage utilis\u00e9 dans le bloc de code.</p> <p></p>"},{"location":"les-exemples-de-ce-document----.html#221-blocs-de-code-enrichi-eclipse-visual-studio","title":"2.2.1. Blocs de code enrichi (Eclipse, Visual Studio, ...)","text":"<p>Voici des blocs de code enrichis par diff\u00e9rents IDE\u00a0:</p> <p>Java</p> <pre><code>\npackage istia.st.spring.core;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Demo01 {\n\n    @SuppressWarnings({ \"unchecked\", \"resource\" })\n    public static void main(String[] args) {\n        // r\u00e9cup\u00e9ration du contexte Spring\n        ApplicationContext ctx = new ClassPathXmlApplicationContext(\"config-01.xml\");\n        // on r\u00e9cup\u00e8re les beans\n        Personne p01 = ctx.getBean(\"personne_01\", Personne.class);\n        Personne p02 = ctx.getBean(\"personne_02\", Personne.class);\n        List&lt;Personne&gt; club = ctx.getBean(\"club\", new ArrayList&lt;Personne&gt;().getClass());\n        Appartement appart01 = ctx.getBean(Appartement.class);\n...\n</code></pre> <p>C#</p> <pre><code>\nusing System;\n\nnamespace Chap1 {\n    class Impots {\n        static void Main(string[] args) {\n            // tableaux de donn\u00e9es n\u00e9cessaires au calcul de l'imp\u00f4t\n            decimal[] limites = { 4962M, 8382M, 14753M, 23888M, 38868M, 47932M, 0M };\n            decimal[] coeffR = { 0M, 0.068M, 0.191M, 0.283M, 0.374M, 0.426M, 0.481M };\n            decimal[] coeffN = { 0M, 291.09M, 1322.92M, 2668.39M, 4846.98M, 6883.66M, 9505.54M };\n\n            // on r\u00e9cup\u00e8re le statut marital\n            bool OK = false;\n            string reponse = null;\n            while (!OK) {\n                Console.Write(\"Etes-vous mari\u00e9(e) (O/N) ? \");\n                reponse = Console.ReadLine().Trim().ToLower();\n                if (reponse != \"o\" &amp;&amp; reponse != \"n\")\n                    Console.Error.WriteLine(\"R\u00e9ponse incorrecte. Recommencez\");\n                else OK = true;\n            }//while\n            bool marie = reponse == \"o\";\n...\n</code></pre> <p>Python</p> <pre><code>\n# ----------------------------------\ndef affiche(chaine):\n    # affiche chaine\n    print(\"chaine=%s\" % chaine)\n\n\n# ----------------------------------\ndef affiche_type(variable):\n    # affiche le type de variable\n    print(\"type[%s]=%s\" % (variable, type(variable)))\n\n\n# ----------------------------------\ndef f1(param):\n    # ajoute 10 \u00e0 param\n    return param + 10\n\n\n# ----------------------------------\ndef f2():\n    # rend un tuple de 3 valeurs\n    return \"un\", 0, 100\n\n\n# -------------------------------- programme principal ------------------------------------\n...\n</code></pre> <p>PHP</p> <pre><code>\n&lt;?php\n\n// types stricts pour les param\u00e8tres de fonctions\ndeclare(strict_types=1);\n\n// constantes globales\ndefine(\"PLAFOND_QF_DEMI_PART\", 1551);\ndefine(\"PLAFOND_REVENUS_CELIBATAIRE_POUR_REDUCTION\", 21037);\ndefine(\"PLAFOND_REVENUS_COUPLE_POUR_REDUCTION\", 42074);\ndefine(\"VALEUR_REDUC_DEMI_PART\", 3797);\ndefine(\"PLAFOND_DECOTE_CELIBATAIRE\", 1196);\ndefine(\"PLAFOND_DECOTE_COUPLE\", 1970);\ndefine(\"PLAFOND_IMPOT_COUPLE_POUR_DECOTE\", 2627);\ndefine(\"PLAFOND_IMPOT_CELIBATAIRE_POUR_DECOTE\", 1595);\ndefine(\"ABATTEMENT_DIXPOURCENT_MAX\", 12502);\ndefine(\"ABATTEMENT_DIXPOURCENT_MIN\", 437);\n\n// d\u00e9finition des constantes locales\n$DATA = \"taxpayersdata.txt\";\n$RESULTATS = \"resultats.txt\";\n$limites = array(9964, 27519, 73779, 156244, 0);\n$coeffR = array(0, 0.14, 0.3, 0.41, 0.45);\n$coeffN = array(0, 1394.96, 5798, 13913.69, 20163.45);\n\n// lecture des donn\u00e9es\n$data = fopen($DATA, \"r\");\nif (!$data) {\n  print \"Impossible d'ouvrir en lecture le fichier des donn\u00e9es [$DATA]\\n\";\n  exit;\n}\n\n...\n</code></pre> <p>ECMAScript</p> <pre><code>\n'use strict';\n// ceci est un commentaire\n// constante\nconst nom = \"dupont\";\n// un affichage \u00e9cran\nconsole.log(\"nom : \", nom);\n// un tableau avec des \u00e9l\u00e9ments de type diff\u00e9rent\nconst tableau = [\"un\", \"deux\", 3, 4];\n// son nombre d'\u00e9l\u00e9ments\nlet n = tableau.length;\n// une boucle\nfor (let i = 0; i &lt; n; i++) {\n  console.log(\"tableau[\", i, \"] = \", tableau[i]);\n}\n// initialisation de 2 variables avec le contenu d'un tableau\nlet [chaine1, chaine2] = [\"chaine1\", \"chaine2\"];\n// concat\u00e9nation des 2 cha\u00eenes\nconst chaine3 = chaine1 + chaine2;\n// affichage r\u00e9sultat\nconsole.log([chaine1, chaine2, chaine3]);\n...\n</code></pre> <p>VBScript</p> <pre><code>\n' calcul de l'imp\u00f4t d'un contribuable\n' le programme doit \u00eatre appel\u00e9 avec trois param\u00e8tres : mari\u00e9 enfants salaire\n' mari\u00e9 : caract\u00e8re O si mari\u00e9, N si non mari\u00e9\n' enfants : nombre d'enfants\n' salaire : salaire annuel sans les centimes\n\n' d\u00e9claration obligatoire des variables\n  Option Explicit\n  Dim erreur\n  \n' on r\u00e9cup\u00e8re les arguments en v\u00e9rifiant leur validit\u00e9\n  Dim marie, enfants, salaire\n  erreur=getArguments(marie,enfants,salaire)\n  ' erreur ?\n  If erreur(0)&lt;&gt;0 Then wscript.echo erreur(1) : wscript.quit erreur(0)\n\n' on r\u00e9cup\u00e8re les donn\u00e9es n\u00e9cessaires au calcul de l'imp\u00f4t\n  Dim limites, coeffR, coeffN\n  erreur=getData(limites,coeffR,coeffN)\n  ' erreur ?\n  If erreur(0)&lt;&gt;0 Then wscript.echo erreur(1) : wscript.quit 5\n\n  ' on affiche le r\u00e9sultat\n  wscript.echo \"imp\u00f4t=\" &amp; calculerImpot(marie,enfants,salaire,limites,coeffR,coeffN)\n  \n  ' on quitte sans erreur\n  wscript.quit 0\n</code></pre> <p>XML</p> <pre><code>\n&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n\n  &lt;configSections&gt;\n    &lt;sectionGroup name=\"spring\"&gt;\n      &lt;section name=\"context\" type=\"Spring.Context.Support.ContextHandler, Spring.Core\" /&gt;\n      &lt;section name=\"objects\" type=\"Spring.Context.Support.DefaultSectionHandler, Spring.Core\" /&gt;\n    &lt;/sectionGroup&gt;\n  &lt;/configSections&gt;\n\n  &lt;spring&gt;\n    &lt;context&gt;\n      &lt;resource uri=\"config://spring/objects\" /&gt;\n    &lt;/context&gt;\n    &lt;objects xmlns=\"http://www.springframework.net\"&gt;\n      &lt;object name=\"dao\" type=\"Dao.DataBaseImpot, ImpotsV7-dao\"&gt;\n        &lt;constructor-arg index=\"0\" value=\"MySql.Data.MySqlClient\"/&gt;\n        &lt;constructor-arg index=\"1\" value=\"Server=localhost;Database=bdimpots;Uid=admimpots;Pwd=mdpimpots;\"/&gt;\n        &lt;constructor-arg index=\"2\" value=\"select limite, coeffr, coeffn from tranches\"/&gt;\n      &lt;/object&gt;\n      &lt;object name=\"metier\" type=\"Metier.ImpotMetier, ImpotsV7-metier\"&gt;\n        &lt;constructor-arg index=\"0\" ref=\"dao\"/&gt;\n      &lt;/object&gt;\n    &lt;/objects&gt;\n  &lt;/spring&gt;\n&lt;/configuration&gt;\n</code></pre>"},{"location":"les-exemples-de-ce-document----.html#222-blocs-de-code-brut-plain-text","title":"2.2.2. Blocs de code brut (plain text)","text":"<p>Voici des exemples de code brut\u00a0:</p> <p>R\u00e9sultats d\u2019ex\u00e9cution</p> <p>On notera que le code ne commence pas avec la ligne n\u00b0 1.</p> <pre><code>C:\\Data\\st-2020\\dev\\python\\cours-2020\\python3-flask-2020\\venv\\Scripts\\python.exe C:/Data/st-2020/dev/python/cours-2020/python3-flask-2020/bases/bases_01.py\nnom=dupont\nliste[0]=un\nliste[1]=deux\nliste[2]=3\nliste[3]=4\n[chaine1,chaine2,chaine1chaine2]\nchaine=chaine1\ntype[4]=&lt;class 'int'&gt;\ntype[chaine1]=&lt;class 'str'&gt;\ntype[['un', 'deux', 3, 4]]=&lt;class 'list'&gt;\ntype[a chang\u00e9]=&lt;class 'str'&gt;\nres1=14s\n(res1,res2,res3)=[un,0,100]\nliste[0]=un\nliste[1]=0\nliste[2]=100\nliste[0]=8\nliste[1]=5\nsomme=13\n\nProcess finished with exit code 0\n</code></pre> <p>Ce cas a n\u00e9cessit\u00e9 des dizaines d\u2019it\u00e9rations. Le convertisseur ne trouvait jamais le num\u00e9ro de la premi\u00e8re ligne de code. Finalement j\u2019ai demand\u00e9 \u00e0 Gemini comment formater le bloc de code pour qu\u2019il le reconnaisse. Voici ce qu\u2019il m\u2019a r\u00e9pondu\u00a0:</p> <p></p> <p>J\u2019ai suivi cette d\u00e9marche et \u00e7a a march\u00e9. Moi j\u2019utilisais la m\u00e9thode via l\u2019ic\u00f4ne de liste (Personnaliser). Donc on peut \u00eatre amen\u00e9 \u00e0 modifier certains \u00e9l\u00e9ments du Document ODT / DOCX pour obtenir ce qu\u2019on veut.</p> <p>Le convertisseur sait g\u00e9rer les blocs de code non num\u00e9rot\u00e9s.</p> <pre><code>liste[0]=un\nliste[1]=0\nliste[2]=100\nliste[0]=8\nliste[1]=5\nsomme=13\n</code></pre> <p>Voici les m\u00eames exemples que dans le paragraphe 2.2.1 mais non enrichis. Ce sont alors les mots cl\u00e9s du fichier de configuration qui vont guider le convertisseur vers le bon langage.</p> <p>Java</p> <pre><code>package istia.st.spring.core;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Demo01 {\n\n@SuppressWarnings({ \"unchecked\", \"resource\" })\npublic static void main(String[] args) {\n// r\u00e9cup\u00e9ration du contexte Spring\nApplicationContext ctx = new ClassPathXmlApplicationContext(\"config-01.xml\");\n// on r\u00e9cup\u00e8re les beans\nPersonne p01 = ctx.getBean(\"personne_01\", Personne.class);\nPersonne p02 = ctx.getBean(\"personne_02\", Personne.class);\nList&lt;Personne&gt; club = ctx.getBean(\"club\", new ArrayList&lt;Personne&gt;().getClass());\nAppartement appart01 = ctx.getBean(Appartement.class);\n...\n</code></pre> <p>C#</p> <pre><code>using System;\n\nnamespace Chap1 {\n    class Impots {\n        static void Main(string[] args) {\n            // tableaux de donn\u00e9es n\u00e9cessaires au calcul de l'imp\u00f4t\n            decimal[] limites = { 4962M, 8382M, 14753M, 23888M, 38868M, 47932M, 0M };\n            decimal[] coeffR = { 0M, 0.068M, 0.191M, 0.283M, 0.374M, 0.426M, 0.481M };\n            decimal[] coeffN = { 0M, 291.09M, 1322.92M, 2668.39M, 4846.98M, 6883.66M, 9505.54M };\n\n            // on r\u00e9cup\u00e8re le statut marital\n            bool OK = false;\n            string reponse = null;\n            while (!OK) {\n                Console.Write(\"Etes-vous mari\u00e9(e) (O/N) ? \");\n                reponse = Console.ReadLine().Trim().ToLower();\n                if (reponse != \"o\" &amp;&amp; reponse != \"n\")\n                    Console.Error.WriteLine(\"R\u00e9ponse incorrecte. Recommencez\");\n                else OK = true;\n            }//while\n            bool marie = reponse == \"o\";\n...\n</code></pre> <p>Python</p> <pre><code># ----------------------------------\ndef affiche(chaine):\n    # affiche chaine\n    print(\"chaine=%s\" % chaine)\n\n\n# ----------------------------------\ndef affiche_type(variable):\n    # affiche le type de variable\n    print(\"type[%s]=%s\" % (variable, type(variable)))\n\n\n# ----------------------------------\ndef f1(param):\n    # ajoute 10 \u00e0 param\n    return param + 10\n\n\n# ----------------------------------\ndef f2():\n    # rend un tuple de 3 valeurs\n    return \"un\", 0, 100\n\n\n# -------------------------------- programme principal ------------------------------------\n...\n</code></pre> <p>PHP</p> <pre><code>&lt;?php\n\n// types stricts pour les param\u00e8tres de fonctions\ndeclare(strict_types=1);\n\n// constantes globales\ndefine(\"PLAFOND_QF_DEMI_PART\", 1551);\ndefine(\"PLAFOND_REVENUS_CELIBATAIRE_POUR_REDUCTION\", 21037);\ndefine(\"PLAFOND_REVENUS_COUPLE_POUR_REDUCTION\", 42074);\ndefine(\"VALEUR_REDUC_DEMI_PART\", 3797);\ndefine(\"PLAFOND_DECOTE_CELIBATAIRE\", 1196);\ndefine(\"PLAFOND_DECOTE_COUPLE\", 1970);\ndefine(\"PLAFOND_IMPOT_COUPLE_POUR_DECOTE\", 2627);\ndefine(\"PLAFOND_IMPOT_CELIBATAIRE_POUR_DECOTE\", 1595);\ndefine(\"ABATTEMENT_DIXPOURCENT_MAX\", 12502);\ndefine(\"ABATTEMENT_DIXPOURCENT_MIN\", 437);\n\n// d\u00e9finition des constantes locales\n$DATA = \"taxpayersdata.txt\";\n$RESULTATS = \"resultats.txt\";\n$limites = array(9964, 27519, 73779, 156244, 0);\n$coeffR = array(0, 0.14, 0.3, 0.41, 0.45);\n$coeffN = array(0, 1394.96, 5798, 13913.69, 20163.45);\n\n// lecture des donn\u00e9es\n$data = fopen($DATA, \"r\");\nif (!$data) {\n  print \"Impossible d'ouvrir en lecture le fichier des donn\u00e9es [$DATA]\\n\";\n  exit;\n}\n\n...\n</code></pre> <p>ECMAScript</p> <pre><code>'use strict';\n// ceci est un commentaire\n// constante\nconst nom = \"dupont\";\n// un affichage \u00e9cran\nconsole.log(\"nom : \", nom);\n// un tableau avec des \u00e9l\u00e9ments de type diff\u00e9rent\nconst tableau = [\"un\", \"deux\", 3, 4];\n// son nombre d'\u00e9l\u00e9ments\nlet n = tableau.length;\n// une boucle\nfor (let i = 0; i &lt; n; i++) {\n  console.log(\"tableau[\", i, \"] = \", tableau[i]);\n}\n// initialisation de 2 variables avec le contenu d'un tableau\nlet [chaine1, chaine2] = [\"chaine1\", \"chaine2\"];\n// concat\u00e9nation des 2 cha\u00eenes\nconst chaine3 = chaine1 + chaine2;\n// affichage r\u00e9sultat\nconsole.log([chaine1, chaine2, chaine3]);\n...\n</code></pre> <p>VBScript</p> <pre><code>' calcul de l'imp\u00f4t d'un contribuable\n' le programme doit \u00eatre appel\u00e9 avec trois param\u00e8tres : mari\u00e9 enfants salaire\n' mari\u00e9 : caract\u00e8re O si mari\u00e9, N si non mari\u00e9\n' enfants : nombre d'enfants\n' salaire : salaire annuel sans les centimes\n\n' d\u00e9claration obligatoire des variables\n  Option Explicit\n  Dim erreur\n\n' on r\u00e9cup\u00e8re les arguments en v\u00e9rifiant leur validit\u00e9\n  Dim marie, enfants, salaire\n  erreur=getArguments(marie,enfants,salaire)\n  ' erreur ?\n  If erreur(0)&lt;&gt;0 Then wscript.echo erreur(1) : wscript.quit erreur(0)\n\n' on r\u00e9cup\u00e8re les donn\u00e9es n\u00e9cessaires au calcul de l'imp\u00f4t\n  Dim limites, coeffR, coeffN\n  erreur=getData(limites,coeffR,coeffN)\n  ' erreur ?\n  If erreur(0)&lt;&gt;0 Then wscript.echo erreur(1) : wscript.quit 5\n\n  ' on affiche le r\u00e9sultat\n  wscript.echo \"imp\u00f4t=\" &amp; calculerImpot(marie,enfants,salaire,limites,coeffR,coeffN)\n\n  ' on quitte sans erreur\n  wscript.quit 0\n</code></pre> <p>XML</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n\n  &lt;configSections&gt;\n    &lt;sectionGroup name=\"spring\"&gt;\n      &lt;section name=\"context\" type=\"Spring.Context.Support.ContextHandler, Spring.Core\" /&gt;\n      &lt;section name=\"objects\" type=\"Spring.Context.Support.DefaultSectionHandler, Spring.Core\" /&gt;\n    &lt;/sectionGroup&gt;\n  &lt;/configSections&gt;\n\n  &lt;spring&gt;\n    &lt;context&gt;\n      &lt;resource uri=\"config://spring/objects\" /&gt;\n    &lt;/context&gt;\n    &lt;objects xmlns=\"http://www.springframework.net\"&gt;\n      &lt;object name=\"dao\" type=\"Dao.DataBaseImpot, ImpotsV7-dao\"&gt;\n        &lt;constructor-arg index=\"0\" value=\"MySql.Data.MySqlClient\"/&gt;\n        &lt;constructor-arg index=\"1\" value=\"Server=localhost;Database=bdimpots;Uid=admimpots;Pwd=mdpimpots;\"/&gt;\n        &lt;constructor-arg index=\"2\" value=\"select limite, coeffr, coeffn from tranches\"/&gt;\n      &lt;/object&gt;\n      &lt;object name=\"metier\" type=\"Metier.ImpotMetier, ImpotsV7-metier\"&gt;\n        &lt;constructor-arg index=\"0\" ref=\"dao\"/&gt;\n      &lt;/object&gt;\n    &lt;/objects&gt;\n  &lt;/spring&gt;\n&lt;/configuration&gt;\n</code></pre> <p>HTML</p> <pre><code>&lt;!DOCTYPE HTML&gt;\n&lt;HTML&gt;\n    &lt;head&gt;\n        &lt;title&gt;Laragon&lt;/title&gt;\n\n        &lt;link href=\"&lt;a href=\"view-source:https://fonts.googleapis.com/css?family=Karla:400\"&gt;https://fonts.googleapis.com/css?family=Karla:400&lt;/a&gt;\" rel=\"stylesheet\" type=\"text/css\"&gt;\n\n        &lt;style&gt;\n            HTML, body {\n                height: 100%;\n            }\n\n            body {\n                margin: 0;\n                padding: 0;\n                width: 100%;\n                display: table;\n                font-weight: 100;\n                font-family: 'Karla';\n            }\n\n            .container {\n                text-align: center;\n                display: table-cell;\n                vertical-align: middle;\n            }\n\n            .content {\n                text-align: center;\n                display: inline-block;\n            }\n\n            .title {\n                font-size: 96px;\n            }\n\n            .opt {\n                margin-top: 30px;\n            }\n\n            .opt a {\n              text-decoration: none;\n              font-size: 150%;\n            }\n\n            a:hover {\n              color: red;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div class=\"container\"&gt;\n            &lt;div class=\"content\"&gt;\n                &lt;div class=\"title\" title=\"Laragon\"&gt;Laragon&lt;/div&gt;\n\n                &lt;div class=\"info\"&gt;&lt;br /&gt;\n                      Apache/2.4.35 (Win64) OpenSSL/1.1.0i PHP/7.2.11&lt;br /&gt;\n                      PHP version: 7.2.11   &lt;span&gt;&lt;a title=\"phpinfo()\" href=\"&lt;a href=\"view-source:http://localhost/?q=info\"&gt;/?q=info&lt;/a&gt;\"&gt;info&lt;/a&gt;&lt;/span&gt;&lt;br /&gt;\n                      Document Root: C:/myprograms/laragon-lite/www&lt;br /&gt;\n\n                &lt;/div&gt;\n</code></pre>"},{"location":"les-exemples-de-ce-document----.html#23-les-liens","title":"2.3. Les liens","text":"<p>Le convertisseur Gemini / ChatGPT sait conserver les liens externes du Document ODT / DOCX. Par exemple Gemini 3 ou [G\u00e9n\u00e9rer un script Python avec des outils d\u2019IA].</p> <p>Il sait g\u00e9rer un lien vers un chapitre Lien vers un chapitre</p> <p>Un renvoi vers un chapitre\u00a0: 2.1.1. </p> <p>Un renvoi vers un rep\u00e8re de texte\u00a0qui pr\u00e9c\u00e8de : Gemini 3</p> <p>Un renvoi vers un rep\u00e8re de texte\u00a0qui suit : GitHub</p>"},{"location":"les-exemples-de-ce-document----.html#24-lenrichissement-de-texte","title":"2.4. L\u2019enrichissement de texte","text":"<p>Le convertisseur sait g\u00e9rer le gras, l\u2019italique, le soulign\u00e9 et le surlignage. Il respecte la couleur du surlignage. </p> <p>Un texte avec des mots en gras, en italiques, soulign\u00e9s ou surlign\u00e9s ou surlign\u00e9s ou surlign\u00e9s.</p> <p>C\u2019est vrai \u00e9galement pour les liens\u00a0: [G\u00e9n\u00e9rer un script Python avec des outils d\u2019IA].</p> <p>Le convertisseur g\u00e8re \u00e9galement la couleur des caract\u00e8res.</p> <p>Il g\u00e8re \u00e9galement les bordures sup\u00e9rieure et inf\u00e9rieure des paragraphes.</p>"},{"location":"les-exemples-de-ce-document----.html#25-un-titre-peut-etre-egalement-enrichi","title":"2.5. Un titre peut \u00eatre \u00e9galement enrichi.","text":""},{"location":"les-exemples-de-ce-document----.html#26-les-images","title":"2.6. Les images","text":"<p>Le convertisseur Gemini / ChatGPT sait g\u00e9rer les images et les tableaux d\u2019images\u00a0:</p> <p></p> <p>Dans les documents ODT il est fr\u00e9quent d\u2019avoir des dessins. Malgr\u00e9 des dizaines de tentatives, Gemini n\u2019a pas r\u00e9ussi \u00e0 g\u00e9n\u00e9rer un script qui g\u00e9n\u00e9rerait l\u2019image (comme une copie d\u2019\u00e9cran) du dessin. Ainsi ci-dessus, l\u2019image 5 est la copie d\u2019\u00e9cran d\u2019un dessin d\u2019un document ODT.</p> <p>Toutes les images sont cliquables pour \u00eatre agrandies. Si ci-dessus on clique sur l\u2019image [1-3], on obtient l\u2019agrandissement suivant\u00a0:</p>"},{"location":"les-exemples-de-ce-document----.html#27-les-caracteres-a-proteger","title":"2.7. Les caract\u00e8res \u00e0 prot\u00e9ger","text":"<p>Un site MkDocs<sup>1</sup> a des pages dont le contenu n\u2019est pas du HTML mais du MarkDown. Si le Document ODT / DOCX contient des caract\u00e8res qui existent en MarkDown, ils risquent d\u2019\u00eatre interpr\u00e9t\u00e9s par MkDocs et donc ne pas avoir le rendu attendu. Voici deux exemples\u00a0:</p> <p>L\u2019ast\u00e9risque * a une signification MarkDown. La ligne suivante peut \u00eatre alors mal interpr\u00e9t\u00e9e\u00a0:</p> <p>L'imp\u00f4t I est alors \u00e9gal \u00e0 0.15*R \u2013 2072.5*nbParts.</p> <p>Un autre exemple est lorsque vous voulez ins\u00e9rer un bloc de code MarkDown dans votre document comme celui-ci\u00a0:</p> <pre><code># Convertisseur Word/ODT vers Site HTML (MkDocs)\n\n\ud83d\udd17 **[Voir le site de d\u00e9monstration g\u00e9n\u00e9r\u00e9](https://stahe.github.io/word-odt-vers-html-janv-2026/)**\n\n---\n\n## \ud83d\udcdd Description\n\nOn se propose dans ce projet de mettre \u00e0 disposition du lecteur un convertisseur Python de documents Word ou ODT vers un site statique HTML.\n\nLorsque le Document ODT / DOCX convient, le convertisseur produit un site HTML via **MkDocs** qui a l'aspect professionnel des sites produits par Pandoc.\n\n## \ud83e\udd16 Contexte de cr\u00e9ation\n\nCe convertisseur a \u00e9t\u00e9 enti\u00e8rement construit par l\u2019IA **Gemini 3** (avec un abonnement pro). Il est le r\u00e9sultat d'it\u00e9rations successives pour g\u00e9rer finement la structure des documents ODT (OpenDocument Text).\n\n## \u2728 Fonctionnalit\u00e9s\n\nLe script `convert.py` effectue les actions suivantes :\n\n* **Conversion ODT vers Markdown** : Analyse le fichier `.odt` (XML) pour en extraire la structure.\n* **Gestion des Titres** : G\u00e9n\u00e8re automatiquement la Table des Mati\u00e8res (TOC) et la navigation lat\u00e9rale.\n* **Blocs de Code** : D\u00e9tection automatique des langages, coloration syntaxique et **gestion pr\u00e9cise de la num\u00e9rotation des lignes** (attributs `start-value`).\n* **Listes** : Support des listes \u00e0 puces et num\u00e9rot\u00e9es avec indentation correcte.\n* **Mise en forme** : Support du *gras*, *italique*, *soulign\u00e9* et du *surlignage* (avec respect des couleurs d'origine).\n* **Images** : Extraction et int\u00e9gration automatique des images contenues dans le document.\n* **Configuration** : Personnalisation via un fichier `config.py` (Bas de page, Google Analytics, etc.).\n\n## \ud83d\ude80 Installation\n\n### Pr\u00e9requis\n\n* Python 3.x\n* Les biblioth\u00e8ques suivantes :\n\n```bash\npip install odfpy unidecode mkdocs mkdocs-material\n\n```\n</code></pre>"},{"location":"les-exemples-de-ce-document----.html#28-les-tableaux","title":"2.8. Les tableaux","text":"<p>Un tableau peut contenir diff\u00e9rents contenus\u00a0:</p> <p>1</p><p>2</p><pre><code>\npackage istia.st.spring.core;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class Demo01 {\n\n\n</code></pre> <p>3</p><p>4</p><pre><code>\n# ----------------------------------\ndef affiche(chaine):\n    # affiche chaine\n    print(\"chaine=%s\" % chaine)\n\n\n# ----------------------------------\ndef affiche_type(variable):\n    # affiche le type de variable\n    print(\"type[%s]=%s\" % (variable, type(variable)))\n\n\n</code></pre> <p>Un tableau contenant des liens\u00a0:</p> <p>Le convertisseur Gemini / ChatGPT sait conserver les</p><p>liens externes du Document ODT / DOCX. Par exemple</p><p>Gemini 3 ou</p><p>[G\u00e9n\u00e9rer un script Python avec des outils d\u2019IA].</p><p>Il sait g\u00e9rer un lien vers un chapitre Lien vers un chapitre</p><p>Un renvoi vers un chapitre\u00a0: 2.1.1. </p><p>Un renvoi vers un rep\u00e8re de texte\u00a0qui pr\u00e9c\u00e8de : Gemini 3</p><p>Un renvoi vers un rep\u00e8re de texte\u00a0qui suit : GitHub</p>"},{"location":"les-exemples-de-ce-document----.html#29-les-notes-de-bas-de-page","title":"2.9. Les notes de bas de page","text":"<p>Le convertisseur Gemini<sup>2</sup> / ChatGPT g\u00e8re les notes de bas de page. Voici une autre note<sup>3</sup> de bas de page.</p> <ol> <li> <p>MkDocs \u21a9</p> </li> <li> <p>Google Gemini \u21a9</p> </li> <li> <p>La note de bas de page\u00a0\u21a9</p> </li> </ol>"},{"location":"utilisation-du-convertisseur-docx---html.html","title":"9. Utilisation du convertisseur DOCX \u2192 HTML","text":"<p>La commande de conversion d\u2019un document Word DOCX est tr\u00e8s analogue \u00e0 celle de la conversion d\u2019un document LibreOffice ODT. Nous allons modifier le style du titre du document dans [config.py]\u00a0:</p> <pre><code>\n    # -------------------------------------------------------------------------\n    # D\u00e9tection du Titre du Document\n    # -------------------------------------------------------------------------\n    \"document_title\": {\n        # Styles ODT \u00e0 consid\u00e9rer comme le titre principal du document (H1 global)\n        \"style_names\": [\n            \"Titre\"\n        ],\n        # CSS appliqu\u00e9 \u00e0 ce titre dans le Markdown g\u00e9n\u00e9r\u00e9\n        \"css\": \"font-size: 28px; font-weight: bold; margin-bottom: 1em; line-height: 1.2; color: #2c3e50;\"\n    },\n</code></pre> <ul> <li>ligne 7\u00a0: mettez \u2018Titre\u2019. C\u2019est le style du document DOCX que vous allez convertir. Nous le verrons dans les lignes de d\u00e9bogage du convertisseur.</li> </ul> <p>Toujours dans le terminal PyCharm, tapez la commande suivante\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python .\\convert_docx_v18.py .\\word-odt-vers-html-janv-2026.docx .\\config.py\nC:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2\\convert_docx_v18.py:976: SyntaxWarning: invalid escape sequence '\\h'\n  - REF Bookmark \\h\n--- DOCX to MkDocs Converter V16 ---\nCopi\u00e9 : google5179c0eaff293e02.html\nCopi\u00e9 : robots.txt\nCopi\u00e9 : word-odt-vers-html-janv-2026.pdf\nCopi\u00e9 : word-odt-vers-html-janv-2026.zip\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Titre heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='&lt;span&gt;Convertir un document Word ou ODT vers un site statique HTML compatible Mk...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='&lt;b&gt;Serge Tah\u00e9&lt;/b&gt;&lt;span&gt;, janvier 2026&lt;/span&gt;...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=Standard heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='...'\n[DEBUG PRE-H1] style=StandardWW heading=None rebase=0 numId=None ilvl=None list=None:0/None txt='&lt;b&gt;Ce site a \u00e9t\u00e9 cr\u00e9\u00e9 avec le convertisseur &amp;#91;Word ou ODT - &amp;gt; HTML&amp;#93; cr...'\n[DEBUG PRE-H1] style=Titre1 heading=1 rebase=0 numId=1 ilvl=0 list=numPr:1/ordered txt='&lt;span&gt;Introduction&lt;/span&gt;...'\nTermin\u00e9. (audit.json, audit.txt, report.txt g\u00e9n\u00e9r\u00e9s)\n</code></pre> <ul> <li>ligne 1\u00a0: la commande est la suivante\u00a0: [python .\\convert_docx_v18.py .\\word-odt-vers-html-janv-2026.docx .\\config.py]\u00a0(Adaptez le num\u00e9ro de version (ici 18) \u00e0 la version que vous avez t\u00e9l\u00e9charg\u00e9e.) :<ul> <li>le premier param\u00e8tre [.\\convert_docx_v18.py] est le convertisseur DOCX \u2192 HTML</li> <li>le second param\u00e8tre [.\\word-odt-vers-html-janv-2026.docx] est le nom du document DOCX \u00e0 convertir\u00a0;</li> <li>le troisi\u00e8me param\u00e8tre [.\\config.py] est le fichier de configuration\u00a0;</li> </ul> </li> <li>ligne 33\u00a0: le convertisseur signale que trois fichiers ont \u00e9t\u00e9 g\u00e9n\u00e9r\u00e9s\u00a0:</li> </ul> <p>Le fichier [audit.txt] est le suivant\u00a0:</p> <pre><code>\nVersion: V16\nParagraphs: 2029\nTables: 97\nImages (blips): 2\nHeadings detected (raw): 53\nMin heading level detected (raw): 1\nRebase offset applied: 0\n\nTop paragraph styles:\n  - SourceCodenumrot: 1054\n  - StandardWW: 594\n  - Standard: 146\n  - Paragraphedeliste: 113\n  - SourceCodenumrotrsultats: 33\n  - codenouveau: 28\n  - Titre2: 25\n  - Titre1: 14\n  - Titre3: 14\n  - StandardWWWW: 6\n  - Textebrut: 1\n  - Titre: 1\n\nList paragraphs:\n  - with numPr: 1329\n  - by style fallback: 49\n  - not recognized: 0\n</code></pre> <ul> <li>ligne 2\u00a0: le nombre de paragraphes du document Word\u00a0;</li> <li>ligne 3\u00a0: le nombre de tables\u00a0;</li> <li>lignes 9-21\u00a0: les styles trouv\u00e9s dans le document\u00a0;<ul> <li>lignes 10, 14, 15\u00a0: le style des blocs de code. Un seul style aurait probablement suffi\u00a0;</li> <li>lignes 11-12, 19\u00a0: le style des paragraphes standard. Un seul style aurait probablement suffi\u00a0;</li> <li>lignes 16-18, 21\u00a0: les styles des titres du document. Ligne 21, on voit qu\u2019un seul paragraphe a le style \u2018Titre\u2019. C\u2019est le titre du document qui pr\u00e9c\u00e8de le premier \u2018Titre1\u2019\u00a0;</li> </ul> </li> </ul> <p>Cet audit du document Word est un bon moyen de juger de la qualit\u00e9 du document. L\u00e0 je vois que j\u2019ai utilis\u00e9 trop de styles diff\u00e9rents pour la m\u00eame chose dans mon document Word.</p> <p>Le fichier [audit.json] est identique au fichier [audit.txt] mais sous une forme jSON\u00a0:</p> <pre><code>\n{\n  \"version\": \"V16\",\n  \"file\": \"word-odt-vers-html-janv-2026.docx\",\n  \"counts\": {\n    \"paragraphs\": 2029,\n    \"tables\": 97,\n    \"image_blips\": 2,\n    \"headings_raw\": 53\n  },\n  \"lists\": {\n    \"with_numpr\": 1329,\n    \"by_style\": 49,\n    \"unrecognized\": 0\n  },\n  \"heading\": {\n    \"min_level_raw\": 1,\n    \"rebase_offset\": 0\n  },\n  \"top_styles\": [\n    [\n      \"SourceCodenumrot\",\n      1054\n    ],\n    [\n      \"StandardWW\",\n      594\n    ],\n    [\n      \"Standard\",\n      146\n    ],\n    [\n      \"Paragraphedeliste\",\n      113\n    ],\n    [\n      \"SourceCodenumrotrsultats\",\n      33\n    ],\n    [\n      \"codenouveau\",\n      28\n    ],\n    [\n      \"Titre2\",\n      25\n    ],\n    [\n      \"Titre1\",\n      14\n    ],\n    [\n      \"Titre3\",\n      14\n    ],\n    [\n      \"StandardWWWW\",\n      6\n    ],\n    [\n      \"Textebrut\",\n      1\n    ],\n    [\n      \"Titre\",\n      1\n    ]\n  ]\n}\n</code></pre> <p>Le fichier [report.txt] est celui-ci\u00a0:</p> <pre><code>\n[SUMMARY] Listes d\u00e9tect\u00e9es via fallback \"par style\" (agr\u00e9g\u00e9)\n  - Paragraphedeliste -&gt; level=1 type=unordered: 49\n\n[SUMMARY] Blocs Word ignor\u00e9s (agr\u00e9g\u00e9)\n  - &lt;w:sectPr&gt;: 1\n</code></pre> <p>Je ne l\u2019ai pas compris\u2026</p> <p>Il est possible de ne demander que l\u2019audit du document Word pour juger de sa qualit\u00e9\u00a0avec le param\u00e8tre [--audit]\u00a0:</p> <pre><code>\npython .\\convert_docx_v18.py .\\word-odt-vers-html-janv-2026.docx .\\config.py --audit\n</code></pre> <p>Dans ce cas, seul l\u2019audit du document est fait. Le site MkDocs n\u2019est pas g\u00e9n\u00e9r\u00e9.</p> <p>Comme il a \u00e9t\u00e9 montr\u00e9 pr\u00e9c\u00e9demment, vous pouvez visualiser le site MkDocs g\u00e9n\u00e9r\u00e9 par le convertisseur\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python -m mkdocs serve\nINFO    -  Building documentation...\nINFO    -  Cleaning site directory\nINFO    -  Documentation built in 0.59 seconds\nINFO    -  [06:05:48] Serving on http://127.0.0.1:8000/word-odt-vers-html-janv-2026/\n</code></pre> <p>Ctrl-Cliquez sur l\u2019URL de la ligne 5\u00a0:</p>"},{"location":"utilisation-du-convertisseur-odt---html.html","title":"8. Utilisation du convertisseur ODT \u2192 HTML","text":"<p>On rappelle que le dossier de travail peut \u00eatre trouv\u00e9 |ICI|.</p> <p>Lan\u00e7ons PyCharm\u00a0:</p> <ul> <li>En [2], ouvrez un nouveau projet\u00a0;</li> </ul> <ul> <li>En [1], s\u00e9lectionner le dossier o\u00f9 vous avez sauvegard\u00e9 le dossier de travail\u00a0;</li> <li>En [2], validez ce choix\u00a0;</li> </ul> <ul> <li>En [1], votre projet Python\u00a0;</li> <li>En [2], validez pour ne pas \u00eatre emb\u00eat\u00e9 par le syst\u00e8me de s\u00e9curit\u00e9 de Windows\u00a0;</li> <li>En [3], choisissez un interpr\u00e9teur Python\u00a0;</li> </ul> <ul> <li>En [1], choisissez l\u2019interpr\u00e9teur Python que vous avez install\u00e9 au paragraphe 5\u00a0;</li> </ul> <p>Le convertisseur Gemini / ChatGPT utilise des d\u00e9pendances Python que vous devez installer. On va demander lesquelles \u00e0 Gemini\u00a0:</p> <p>La r\u00e9ponse de Gemini est la suivante\u00a0:</p> <p>On va installer ces d\u00e9pendances\u00a0:</p> <ul> <li>En [1], ouvrez un terminal\u00a0;</li> </ul> <ul> <li>En [2], tapez la commande donn\u00e9e par Gemini\u00a0;</li> </ul> <p>La r\u00e9ponse est la suivante\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; pip install odfpy unidecode mkdocs mkdocs-material\nDefaulting to user installation because normal site-packages is not writeable\nRequirement already satisfied: odfpy in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (1.4.1)\nRequirement already satisfied: unidecode in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (1.4.0)\nRequirement already satisfied: mkdocs in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (1.6.1)\nRequirement already satisfied: mkdocs-material in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (9.7.0)\nRequirement already satisfied: defusedxml in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from odfpy) (0.7.1)\nRequirement already satisfied: click&gt;=7.0 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (8.3.1)\nRequirement already satisfied: colorama&gt;=0.4 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (0.4.6)\nRequirement already satisfied: ghp-import&gt;=1.0 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (2.1.0)\nRequirement already satisfied: jinja2&gt;=2.11.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (3.1.6)\nRequirement already satisfied: markdown&gt;=3.3.6 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (3.10)\nRequirement already satisfied: markupsafe&gt;=2.0.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (3.0.2)\nRequirement already satisfied: mergedeep&gt;=1.3.4 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (1.3.4)\nRequirement already satisfied: mkdocs-get-deps&gt;=0.2.0 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (0.2.0)\nRequirement already satisfied: packaging&gt;=20.5 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (25.0)\nRequirement already satisfied: pathspec&gt;=0.11.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (0.12.1)\nRequirement already satisfied: pyyaml-env-tag&gt;=0.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (1.1)\nRequirement already satisfied: pyyaml&gt;=5.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (6.0.2)\nRequirement already satisfied: watchdog&gt;=2.0 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs) (6.0.0)\nRequirement already satisfied: babel&gt;=2.10 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (2.17.0)\nRequirement already satisfied: backrefs&gt;=5.7.post1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (6.1)\nRequirement already satisfied: mkdocs-material-extensions&gt;=1.3 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (1.3.1)\nRequirement already satisfied: paginate&gt;=0.5 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (0.5.7)\nRequirement already satisfied: pygments&gt;=2.16 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (2.19.2)\nRequirement already satisfied: pymdown-extensions&gt;=10.2 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (10.17.2)\nRequirement already satisfied: requests&gt;=2.26 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-material) (2.32.5)\nRequirement already satisfied: python-dateutil&gt;=2.8.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from ghp-import&gt;=1.0-&gt;mkdocs) (2.9.0.post0)\nRequirement already satisfied: platformdirs&gt;=2.2.0 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from mkdocs-get-deps&gt;=0.2.0-&gt;mkdocs) (4.5.0)\nRequirement already satisfied: six&gt;=1.5 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from python-dateutil&gt;=2.8.1-&gt;ghp-import&gt;=1.0-&gt;mkdocs) (1.17.0)\nRequirement already satisfied: charset_normalizer&lt;4,&gt;=2 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from requests&gt;=2.26-&gt;mkdocs-material) (3.4.3)\nRequirement already satisfied: idna&lt;4,&gt;=2.5 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from requests&gt;=2.26-&gt;mkdocs-material) (3.10)\nRequirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from requests&gt;=2.26-&gt;mkdocs-material) (2.5.0)\nRequirement already satisfied: certifi&gt;=2017.4.17 in c:\\users\\serge\\appdata\\roaming\\python\\python313\\site-packages (from requests&gt;=2.26-&gt;mkdocs-material) (2025.8.3)\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; \n</code></pre> <p>Sur mon PC, tout \u00e9tait d\u00e9j\u00e0 install\u00e9. Si ce n\u2019est pas votre cas, toutes les d\u00e9pendances demand\u00e9es vont \u00eatre install\u00e9es.</p> <p>Maintenant, nous pouvons utiliser le convertisseur. Dans le terminal ouvert, tapez la commande suivante\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python .\\convert_odt_v356.py .\\word-odt-vers-html-janv-2026.odt .\\config.py      \n--- ODT to MkDocs Converter V356 ---\nTraitement de .\\word-odt-vers-html-janv-2026.odt...\nCopi\u00e9 : google5179c0eaff293e02.html\nCopi\u00e9 : robots.txt\nCopi\u00e9 : word-odt-vers-html-janv-2026.pdf\nCopi\u00e9 : word-odt-vers-html-janv-2026.zip\nScan des renvois...\nG\u00e9n\u00e9ration Markdown...\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard (WW)' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='Standard (WW)' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P1' Text='Convertir un document Word ou ODT vers un site sta...'\n&gt;&gt;&gt; TITRE DOCUMENT TROUV\u00c9 : Convertir un document Word ou ODT vers un site statique HTML compatible MkDocs avec les IA Gemini 3 et ChatGPT 5.2\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P3' Text='Serge Tah\u00e9, janvier 2026...'\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P2' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P4' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P4' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P4' Text='...'\n[DEBUG PRE-H1] Tag=text:p Style='P4' Text='Ce site a \u00e9t\u00e9 cr\u00e9\u00e9 avec le convertisseur [Word ou ...'\n[DEBUG PRE-H1] Tag=text:h Style='P5' Text='Introduction...'\n&gt;&gt;&gt; CHAPITRE 1: 1 Introduction\n&gt;&gt;&gt; CHAPITRE 1: 2 Les exemples de ce document\n&gt;&gt;&gt; CHAPITRE 2: 2.1 Les listes\n&gt;&gt;&gt; CHAPITRE 3: 2.1.1 Listes \u00e0 puces\n&gt;&gt;&gt; CHAPITRE 3: 2.1.2 Listes num\u00e9rot\u00e9es\n&gt;&gt;&gt; CHAPITRE 3: 2.1.3 Listes mixtes 1\n&gt;&gt;&gt; CHAPITRE 3: 2.1.4 Listes mixtes 2\n&gt;&gt;&gt; CHAPITRE 2: 2.2 Les blocs de code\n&gt;&gt;&gt; CHAPITRE 3: 2.2.1 Blocs de code enrichi (Eclipse, Visual Studio, ...)\n&gt;&gt;&gt; CHAPITRE 3: 2.2.2 Blocs de code brut (plain text)\n&gt;&gt;&gt; CHAPITRE 2: 2.3 Les liens\n&gt;&gt;&gt; CHAPITRE 2: 2.4 L\u2019enrichissement de texte\n&gt;&gt;&gt; CHAPITRE 2: 2.5 Un titre peut \u00eatre \u00e9galement enrichi.\n&gt;&gt;&gt; CHAPITRE 2: 2.6 Les images\n&gt;&gt;&gt; CHAPITRE 2: 2.7 Les caract\u00e8res \u00e0 prot\u00e9ger\n&gt;&gt;&gt; CHAPITRE 2: 2.8 Les tableaux\n&gt;&gt;&gt; CHAPITRE 2: 2.9 Les notes de bas de page\n&gt;&gt;&gt; CHAPITRE 1: 3 Ce qui existe sur internet\n&gt;&gt;&gt; CHAPITRE 1: 4 Le prompt initial \u00e0 Gemini 3\n&gt;&gt;&gt; CHAPITRE 1: 5 Cr\u00e9er un environnement de travail Python\n&gt;&gt;&gt; CHAPITRE 1: 6 Le dossier de travail du convertisseur\n&gt;&gt;&gt; CHAPITRE 1: 7 Le fichier de configuration du convertisseur\n&gt;&gt;&gt; CHAPITRE 1: 8 Utilisation du convertisseur ODT \u2192 HTML\n&gt;&gt;&gt; CHAPITRE 1: 9 Utilisation du convertisseur DOCX \u2192 HTML\n&gt;&gt;&gt; CHAPITRE 1: 10 Construction du site HTML statique\n&gt;&gt;&gt; CHAPITRE 1: 11 Examen du site HTML g\u00e9n\u00e9r\u00e9\n&gt;&gt;&gt; CHAPITRE 2: 11.1 La barre sup\u00e9rieure du site\n&gt;&gt;&gt; CHAPITRE 2: 11.2 Le bas de page du site\n&gt;&gt;&gt; CHAPITRE 2: 11.3 La page d\u2019accueil\n&gt;&gt;&gt; CHAPITRE 2: 11.4 Les listes \u00e0 puces\n&gt;&gt;&gt; CHAPITRE 2: 11.5 Les listes num\u00e9rot\u00e9es\n&gt;&gt;&gt; CHAPITRE 3: 11.5.1 Listes mixtes 1\n&gt;&gt;&gt; CHAPITRE 3: 11.5.2 Listes mixtes 2\n&gt;&gt;&gt; CHAPITRE 2: 11.6 Les blocs de code enrichis\n&gt;&gt;&gt; CHAPITRE 3: 11.6.1 Exemple 1\n&gt;&gt;&gt; CHAPITRE 3: 11.6.2 Exemple 2\n&gt;&gt;&gt; CHAPITRE 3: 11.6.3 Exemple 3\n&gt;&gt;&gt; CHAPITRE 2: 11.7 Les blocs de code brut (plain text)\n&gt;&gt;&gt; CHAPITRE 3: 11.7.1 Exemple 1\n&gt;&gt;&gt; CHAPITRE 3: 11.7.2 Exemple 2\n&gt;&gt;&gt; CHAPITRE 3: 11.7.3 Exemple 3\n&gt;&gt;&gt; CHAPITRE 2: 11.8 Autres blocs de code\n&gt;&gt;&gt; CHAPITRE 2: 11.9 Les liens\n&gt;&gt;&gt; CHAPITRE 2: 11.10 L\u2019enrichissement de texte\n&gt;&gt;&gt; CHAPITRE 2: 11.11 Les images\n&gt;&gt;&gt; CHAPITRE 2: 11.12 Les caract\u00e8res prot\u00e9g\u00e9s\n&gt;&gt;&gt; CHAPITRE 2: 11.13 Les tableaux\n&gt;&gt;&gt; CHAPITRE 2: 11.14 Notes de bas de page\n&gt;&gt;&gt; CHAPITRE 2: 11.15 Anomalies connues\n&gt;&gt;&gt; CHAPITRE 2: 11.16 Autres cas\n&gt;&gt;&gt; CHAPITRE 1: 12 H\u00e9berger le site HTML sur GitHub\n&gt;&gt;&gt; CHAPITRE 1: 13 Assurer le suivi du site avec Google Analytics et Google Search Console\n&gt;&gt;&gt; CHAPITRE 1: 14 Conclusion\nTermin\u00e9.\n</code></pre> <ul> <li>Ligne 1\u00a0: la commande qui convertit le document ODT en site MkDocs\u00a0[python convert_odt_v356.py  .\\word-odt-vers-html-janv-2026.odt .\\config.py]. ]. Adaptez le num\u00e9ro de version (ici 356) \u00e0 la version que vous avez t\u00e9l\u00e9charg\u00e9e. Le premier param\u00e8tre du convertisseur est le document ODT \u00e0 convertir, le second le fichier de configuration du convertisseur\u00a0;</li> <li>lignes 4-7\u00a0: les fichiers que le convertisseur copie \u00e0 la racine du site MkDocs qu\u2019il cr\u00e9e\u00a0;</li> <li>lignes 10-34\u00a0: le d\u00e9bogage des styles des paragraphes qui pr\u00e9c\u00e8dent le premier titre de niveau 1. Ces paragraphes vont constituer la page d\u2019accueil. Un des paragraphes joue le r\u00f4le de titre de la page d\u2019accueil et donc du site. C\u2019est le paragraphe de la ligne 21. On note son style P1. On doit mettre ce style dans le fichier de configuration\u00a0:</li> </ul> <pre><code>\n    # -------------------------------------------------------------------------\n    # D\u00e9tection du Titre du Document\n    # -------------------------------------------------------------------------\n    \"document_title\": {\n        # Styles ODT \u00e0 consid\u00e9rer comme le titre principal du document (H1 global)\n        \"style_names\": [\n            \"P1\"\n        ],\n        # CSS appliqu\u00e9 \u00e0 ce titre dans le Markdown g\u00e9n\u00e9r\u00e9\n        \"css\": \"font-size: 28px; font-weight: bold; margin-bottom: 1em; line-height: 1.2; color: #2c3e50;\"\n    },\n</code></pre> <ul> <li>lignes 35-88\u00a0: j\u2019ai demand\u00e9 \u00e0 l\u2019IA de loguer tous les chapitres qu\u2019il rencontrait\u00a0;</li> </ul> <p>Cette ex\u00e9cution a modifi\u00e9 votre dossier de travail\u00a0:</p> <ul> <li>En [1], [docs] est le site MkDocs que le convertisseur Gemini / ChatGPT a cr\u00e9\u00e9. Vous pouvez avoir la curiosit\u00e9 de le visiter\u00a0;</li> <li>en [2], un dossier [overrides] a \u00e9t\u00e9 cr\u00e9\u00e9. Il va \u00eatre utilis\u00e9 par le constructeur [build] du site HTML\u00a0;</li> <li>en [3]\u00a0: [analytics.html] sera utilis\u00e9 pour le suivi du site par Google Analytics. [footer.html] est le bas de page que vous avez d\u00e9fini dans le fichier [config.py]\u00a0;</li> </ul> <p>On pourrait utiliser le site MkDocs d\u00e8s maintenant. La commande [python -m mkdocs serve] permet de le visualiser. Vous pouvez essayer\u00a0:</p> <pre><code>\nPS C:\\Data\\st-2025\\GitHub Pages\\word-odt-vers-html\\v2&gt; python -m mkdocs serve\nINFO    -  Building documentation...\nINFO    -  Cleaning site directory\nINFO    -  Doc file 'les-exemples.md' contains a link '#_Les_exemples', but there is no such anchor on this page.\nINFO    -  Documentation built in 0.41 seconds\nINFO    -  [15:46:06] Serving on http://127.0.0.1:8000/word-odt-vers-html-janv-2026/\n</code></pre> <p>Ctrl-cliquez sur le lien de la ligne 6. Le site MkDocs doit appara\u00eetre\u00a0:</p> <p>Voici le fruit d\u2019un long travail. Pour arr\u00eater le serveur de MkDocs, faites simplement Ctrl-C dans le terminal qui l\u2019a lanc\u00e9.</p>"}]}